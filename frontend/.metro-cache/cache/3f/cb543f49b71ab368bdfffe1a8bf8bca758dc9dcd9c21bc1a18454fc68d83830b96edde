{"dependencies":[{"name":"../config/firebase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"K/SZPG5sPeV1upVh8dao26aG7MQ=","exportNames":["*"],"imports":1}},{"name":"firebase/database","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":47},"end":{"line":2,"column":104,"index":151}}],"key":"ZF/J3nfk5GUgbzXl84BqV1IxYEE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _configFirebase = require(_dependencyMap[0], \"../config/firebase\");\n  var _firebaseDatabase = require(_dependencyMap[1], \"firebase/database\");\n  class ChatService {\n    // Send a message\n    async sendMessage(bookingId, senderId, senderName, senderType, message) {\n      try {\n        const messagesRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/messages`);\n        const newMessage = {\n          bookingId,\n          senderId,\n          senderName,\n          senderType,\n          message,\n          timestamp: Date.now(),\n          read: false\n        };\n        await (0, _firebaseDatabase.push)(messagesRef, newMessage);\n\n        // Update chat metadata\n        await this.updateChatMetadata(bookingId, message, senderType);\n      } catch (error) {\n        console.error('Error sending message:', error);\n        throw error;\n      }\n    }\n\n    // Listen to messages in real-time\n    listenToMessages(bookingId, callback) {\n      const messagesRef = (0, _firebaseDatabase.query)((0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/messages`), (0, _firebaseDatabase.orderByChild)('timestamp'), (0, _firebaseDatabase.limitToLast)(100));\n      const listener = (0, _firebaseDatabase.onValue)(messagesRef, snapshot => {\n        const messages = [];\n        snapshot.forEach(childSnapshot => {\n          messages.push(Object.assign({\n            id: childSnapshot.key || undefined\n          }, childSnapshot.val()));\n        });\n        callback(messages);\n      });\n\n      // Return cleanup function\n      return () => {\n        (0, _firebaseDatabase.off)(messagesRef);\n      };\n    }\n\n    // Mark messages as read\n    async markMessagesAsRead(bookingId, userId, userType) {\n      try {\n        const messagesRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/messages`);\n        const snapshot = await (0, _firebaseDatabase.get)(messagesRef);\n        const updates = {};\n        snapshot.forEach(childSnapshot => {\n          const message = childSnapshot.val();\n          // Mark as read if the message is from the other party\n          if (message.senderId !== userId && !message.read) {\n            updates[`${childSnapshot.key}/read`] = true;\n          }\n        });\n        if (Object.keys(updates).length > 0) {\n          const messagesRefWithUpdates = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/messages`);\n          await (0, _firebaseDatabase.set)(messagesRefWithUpdates, updates);\n        }\n\n        // Reset unread count\n        const metadataRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata`);\n        if (userType === 'customer') {\n          await (0, _firebaseDatabase.set)((0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata/unreadCountCustomer`), 0);\n        } else {\n          await (0, _firebaseDatabase.set)((0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata/unreadCountProfessional`), 0);\n        }\n      } catch (error) {\n        console.error('Error marking messages as read:', error);\n      }\n    }\n\n    // Update chat metadata\n    async updateChatMetadata(bookingId, lastMessage, senderType) {\n      try {\n        const metadataRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata`);\n        const snapshot = await (0, _firebaseDatabase.get)(metadataRef);\n        const currentMetadata = snapshot.val() || {};\n        const updates = {\n          lastMessage: lastMessage.substring(0, 100),\n          lastMessageTimestamp: Date.now()\n        };\n\n        // Increment unread count for the receiver\n        if (senderType === 'customer') {\n          updates['unreadCountProfessional'] = (currentMetadata.unreadCountProfessional || 0) + 1;\n        } else {\n          updates['unreadCountCustomer'] = (currentMetadata.unreadCountCustomer || 0) + 1;\n        }\n        await (0, _firebaseDatabase.set)(metadataRef, Object.assign({}, currentMetadata, updates));\n      } catch (error) {\n        console.error('Error updating chat metadata:', error);\n      }\n    }\n\n    // Initialize chat metadata\n    async initializeChatMetadata(bookingId, customerId, customerName, professionalId, professionalName) {\n      try {\n        const metadataRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata`);\n        const snapshot = await (0, _firebaseDatabase.get)(metadataRef);\n        if (!snapshot.exists()) {\n          const metadata = {\n            bookingId,\n            customerId,\n            customerName,\n            professionalId,\n            professionalName,\n            lastMessage: '',\n            lastMessageTimestamp: Date.now(),\n            unreadCountCustomer: 0,\n            unreadCountProfessional: 0\n          };\n          await (0, _firebaseDatabase.set)(metadataRef, metadata);\n        }\n      } catch (error) {\n        console.error('Error initializing chat metadata:', error);\n      }\n    }\n\n    // Get unread count\n    async getUnreadCount(bookingId, userType) {\n      try {\n        const field = userType === 'customer' ? 'unreadCountCustomer' : 'unreadCountProfessional';\n        const unreadRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata/${field}`);\n        const snapshot = await (0, _firebaseDatabase.get)(unreadRef);\n        return snapshot.val() || 0;\n      } catch (error) {\n        console.error('Error getting unread count:', error);\n        return 0;\n      }\n    }\n\n    // Get all chats for a user\n    async getUserChats(userId, userType) {\n      try {\n        const chatsRef = (0, _firebaseDatabase.ref)(_configFirebase.database, 'chats');\n        const snapshot = await (0, _firebaseDatabase.get)(chatsRef);\n        const chats = [];\n        snapshot.forEach(childSnapshot => {\n          const metadata = childSnapshot.val().metadata;\n          if (metadata) {\n            const isUserChat = userType === 'customer' ? metadata.customerId === userId : metadata.professionalId === userId;\n            if (isUserChat) {\n              chats.push(metadata);\n            }\n          }\n        });\n\n        // Sort by last message timestamp\n        chats.sort((a, b) => b.lastMessageTimestamp - a.lastMessageTimestamp);\n        return chats;\n      } catch (error) {\n        console.error('Error getting user chats:', error);\n        return [];\n      }\n    }\n  }\n  var _default = new ChatService();\n});","lineCount":174,"map":[[7,2,226,0,"Object"],[7,8,226,0],[7,9,226,0,"defineProperty"],[7,23,226,0],[7,24,226,0,"exports"],[7,31,226,0],[8,4,226,0,"enumerable"],[8,14,226,0],[9,4,226,0,"get"],[9,7,226,0],[9,18,226,0,"get"],[9,19,226,0],[10,6,226,0],[10,13,226,0,"_default"],[10,21,226,0],[11,4,226,0],[12,2,226,0],[13,2,1,0],[13,6,1,0,"_configFirebase"],[13,21,1,0],[13,24,1,0,"require"],[13,31,1,0],[13,32,1,0,"_dependencyMap"],[13,46,1,0],[14,2,2,0],[14,6,2,0,"_firebaseDatabase"],[14,23,2,0],[14,26,2,0,"require"],[14,33,2,0],[14,34,2,0,"_dependencyMap"],[14,48,2,0],[15,2,27,0],[15,8,27,6,"ChatService"],[15,19,27,17],[15,20,27,18],[16,4,28,2],[17,4,29,2],[17,10,29,8,"sendMessage"],[17,21,29,19,"sendMessage"],[17,22,30,4,"bookingId"],[17,31,30,21],[17,33,31,4,"senderId"],[17,41,31,20],[17,43,32,4,"senderName"],[17,53,32,22],[17,55,33,4,"senderType"],[17,65,33,43],[17,67,34,4,"message"],[17,74,34,19],[17,76,35,19],[18,6,36,4],[18,10,36,8],[19,8,37,6],[19,14,37,12,"messagesRef"],[19,25,37,23],[19,28,37,26],[19,32,37,26,"ref"],[19,49,37,29],[19,50,37,29,"ref"],[19,53,37,29],[19,55,37,30,"database"],[19,70,37,38],[19,71,37,38,"database"],[19,79,37,38],[19,81,37,40],[19,90,37,49,"bookingId"],[19,99,37,58],[19,110,37,69],[19,111,37,70],[20,8,38,6],[20,14,38,12,"newMessage"],[20,24,38,47],[20,27,38,50],[21,10,39,8,"bookingId"],[21,19,39,17],[22,10,40,8,"senderId"],[22,18,40,16],[23,10,41,8,"senderName"],[23,20,41,18],[24,10,42,8,"senderType"],[24,20,42,18],[25,10,43,8,"message"],[25,17,43,15],[26,10,44,8,"timestamp"],[26,19,44,17],[26,21,44,19,"Date"],[26,25,44,23],[26,26,44,24,"now"],[26,29,44,27],[26,30,44,28],[26,31,44,29],[27,10,45,8,"read"],[27,14,45,12],[27,16,45,14],[28,8,46,6],[28,9,46,7],[29,8,48,6],[29,14,48,12],[29,18,48,12,"push"],[29,35,48,16],[29,36,48,16,"push"],[29,40,48,16],[29,42,48,17,"messagesRef"],[29,53,48,28],[29,55,48,30,"newMessage"],[29,65,48,40],[29,66,48,41],[31,8,50,6],[32,8,51,6],[32,14,51,12],[32,18,51,16],[32,19,51,17,"updateChatMetadata"],[32,37,51,35],[32,38,51,36,"bookingId"],[32,47,51,45],[32,49,51,47,"message"],[32,56,51,54],[32,58,51,56,"senderType"],[32,68,51,66],[32,69,51,67],[33,6,52,4],[33,7,52,5],[33,8,52,6],[33,15,52,13,"error"],[33,20,52,18],[33,22,52,20],[34,8,53,6,"console"],[34,15,53,13],[34,16,53,14,"error"],[34,21,53,19],[34,22,53,20],[34,46,53,44],[34,48,53,46,"error"],[34,53,53,51],[34,54,53,52],[35,8,54,6],[35,14,54,12,"error"],[35,19,54,17],[36,6,55,4],[37,4,56,2],[39,4,58,2],[40,4,59,2,"listenToMessages"],[40,20,59,18,"listenToMessages"],[40,21,60,4,"bookingId"],[40,30,60,21],[40,32,61,4,"callback"],[40,40,61,47],[40,42,62,16],[41,6,63,4],[41,12,63,10,"messagesRef"],[41,23,63,21],[41,26,63,24],[41,30,63,24,"query"],[41,47,63,29],[41,48,63,29,"query"],[41,53,63,29],[41,55,64,6],[41,59,64,6,"ref"],[41,76,64,9],[41,77,64,9,"ref"],[41,80,64,9],[41,82,64,10,"database"],[41,97,64,18],[41,98,64,18,"database"],[41,106,64,18],[41,108,64,20],[41,117,64,29,"bookingId"],[41,126,64,38],[41,137,64,49],[41,138,64,50],[41,140,65,6],[41,144,65,6,"orderByChild"],[41,161,65,18],[41,162,65,18,"orderByChild"],[41,174,65,18],[41,176,65,19],[41,187,65,30],[41,188,65,31],[41,190,66,6],[41,194,66,6,"limitToLast"],[41,211,66,17],[41,212,66,17,"limitToLast"],[41,223,66,17],[41,225,66,18],[41,228,66,21],[41,229,67,4],[41,230,67,5],[42,6,69,4],[42,12,69,10,"listener"],[42,20,69,18],[42,23,69,21],[42,27,69,21,"onValue"],[42,44,69,28],[42,45,69,28,"onValue"],[42,52,69,28],[42,54,69,29,"messagesRef"],[42,65,69,40],[42,67,69,43,"snapshot"],[42,75,69,51],[42,79,69,56],[43,8,70,6],[43,14,70,12,"messages"],[43,22,70,35],[43,25,70,38],[43,27,70,40],[44,8,71,6,"snapshot"],[44,16,71,14],[44,17,71,15,"forEach"],[44,24,71,22],[44,25,71,24,"childSnapshot"],[44,38,71,37],[44,42,71,42],[45,10,72,8,"messages"],[45,18,72,16],[45,19,72,17,"push"],[45,23,72,21],[45,24,72,21,"Object"],[45,30,72,21],[45,31,72,21,"assign"],[45,37,72,21],[46,12,73,10,"id"],[46,14,73,12],[46,16,73,14,"childSnapshot"],[46,29,73,27],[46,30,73,28,"key"],[46,33,73,31],[46,37,73,35,"undefined"],[47,10,73,44],[47,13,74,13,"childSnapshot"],[47,26,74,26],[47,27,74,27,"val"],[47,30,74,30],[47,31,74,31],[47,32,74,32],[47,33,75,9],[47,34,75,10],[48,8,76,6],[48,9,76,7],[48,10,76,8],[49,8,77,6,"callback"],[49,16,77,14],[49,17,77,15,"messages"],[49,25,77,23],[49,26,77,24],[50,6,78,4],[50,7,78,5],[50,8,78,6],[52,6,80,4],[53,6,81,4],[53,13,81,11],[53,19,81,17],[54,8,82,6],[54,12,82,6,"off"],[54,29,82,9],[54,30,82,9,"off"],[54,33,82,9],[54,35,82,10,"messagesRef"],[54,46,82,21],[54,47,82,22],[55,6,83,4],[55,7,83,5],[56,4,84,2],[58,4,86,2],[59,4,87,2],[59,10,87,8,"markMessagesAsRead"],[59,28,87,26,"markMessagesAsRead"],[59,29,88,4,"bookingId"],[59,38,88,21],[59,40,89,4,"userId"],[59,46,89,18],[59,48,90,4,"userType"],[59,56,90,41],[59,58,91,19],[60,6,92,4],[60,10,92,8],[61,8,93,6],[61,14,93,12,"messagesRef"],[61,25,93,23],[61,28,93,26],[61,32,93,26,"ref"],[61,49,93,29],[61,50,93,29,"ref"],[61,53,93,29],[61,55,93,30,"database"],[61,70,93,38],[61,71,93,38,"database"],[61,79,93,38],[61,81,93,40],[61,90,93,49,"bookingId"],[61,99,93,58],[61,110,93,69],[61,111,93,70],[62,8,94,6],[62,14,94,12,"snapshot"],[62,22,94,20],[62,25,94,23],[62,31,94,29],[62,35,94,29,"get"],[62,52,94,32],[62,53,94,32,"get"],[62,56,94,32],[62,58,94,33,"messagesRef"],[62,69,94,44],[62,70,94,45],[63,8,96,6],[63,14,96,12,"updates"],[63,21,96,43],[63,24,96,46],[63,25,96,47],[63,26,96,48],[64,8,97,6,"snapshot"],[64,16,97,14],[64,17,97,15,"forEach"],[64,24,97,22],[64,25,97,24,"childSnapshot"],[64,38,97,37],[64,42,97,42],[65,10,98,8],[65,16,98,14,"message"],[65,23,98,21],[65,26,98,24,"childSnapshot"],[65,39,98,37],[65,40,98,38,"val"],[65,43,98,41],[65,44,98,42],[65,45,98,43],[66,10,99,8],[67,10,100,8],[67,14,100,12,"message"],[67,21,100,19],[67,22,100,20,"senderId"],[67,30,100,28],[67,35,100,33,"userId"],[67,41,100,39],[67,45,100,43],[67,46,100,44,"message"],[67,53,100,51],[67,54,100,52,"read"],[67,58,100,56],[67,60,100,58],[68,12,101,10,"updates"],[68,19,101,17],[68,20,101,18],[68,23,101,21,"childSnapshot"],[68,36,101,34],[68,37,101,35,"key"],[68,40,101,38],[68,47,101,45],[68,48,101,46],[68,51,101,49],[68,55,101,53],[69,10,102,8],[70,8,103,6],[70,9,103,7],[70,10,103,8],[71,8,105,6],[71,12,105,10,"Object"],[71,18,105,16],[71,19,105,17,"keys"],[71,23,105,21],[71,24,105,22,"updates"],[71,31,105,29],[71,32,105,30],[71,33,105,31,"length"],[71,39,105,37],[71,42,105,40],[71,43,105,41],[71,45,105,43],[72,10,106,8],[72,16,106,14,"messagesRefWithUpdates"],[72,38,106,36],[72,41,106,39],[72,45,106,39,"ref"],[72,62,106,42],[72,63,106,42,"ref"],[72,66,106,42],[72,68,106,43,"database"],[72,83,106,51],[72,84,106,51,"database"],[72,92,106,51],[72,94,106,53],[72,103,106,62,"bookingId"],[72,112,106,71],[72,123,106,82],[72,124,106,83],[73,10,107,8],[73,16,107,14],[73,20,107,14,"set"],[73,37,107,17],[73,38,107,17,"set"],[73,41,107,17],[73,43,107,18,"messagesRefWithUpdates"],[73,65,107,40],[73,67,107,42,"updates"],[73,74,107,49],[73,75,107,50],[74,8,108,6],[76,8,110,6],[77,8,111,6],[77,14,111,12,"metadataRef"],[77,25,111,23],[77,28,111,26],[77,32,111,26,"ref"],[77,49,111,29],[77,50,111,29,"ref"],[77,53,111,29],[77,55,111,30,"database"],[77,70,111,38],[77,71,111,38,"database"],[77,79,111,38],[77,81,111,40],[77,90,111,49,"bookingId"],[77,99,111,58],[77,110,111,69],[77,111,111,70],[78,8,112,6],[78,12,112,10,"userType"],[78,20,112,18],[78,25,112,23],[78,35,112,33],[78,37,112,35],[79,10,113,8],[79,16,113,14],[79,20,113,14,"set"],[79,37,113,17],[79,38,113,17,"set"],[79,41,113,17],[79,43,113,18],[79,47,113,18,"ref"],[79,64,113,21],[79,65,113,21,"ref"],[79,68,113,21],[79,70,113,22,"database"],[79,85,113,30],[79,86,113,30,"database"],[79,94,113,30],[79,96,113,32],[79,105,113,41,"bookingId"],[79,114,113,50],[79,145,113,81],[79,146,113,82],[79,148,113,84],[79,149,113,85],[79,150,113,86],[80,8,114,6],[80,9,114,7],[80,15,114,13],[81,10,115,8],[81,16,115,14],[81,20,115,14,"set"],[81,37,115,17],[81,38,115,17,"set"],[81,41,115,17],[81,43,115,18],[81,47,115,18,"ref"],[81,64,115,21],[81,65,115,21,"ref"],[81,68,115,21],[81,70,115,22,"database"],[81,85,115,30],[81,86,115,30,"database"],[81,94,115,30],[81,96,115,32],[81,105,115,41,"bookingId"],[81,114,115,50],[81,149,115,85],[81,150,115,86],[81,152,115,88],[81,153,115,89],[81,154,115,90],[82,8,116,6],[83,6,117,4],[83,7,117,5],[83,8,117,6],[83,15,117,13,"error"],[83,20,117,18],[83,22,117,20],[84,8,118,6,"console"],[84,15,118,13],[84,16,118,14,"error"],[84,21,118,19],[84,22,118,20],[84,55,118,53],[84,57,118,55,"error"],[84,62,118,60],[84,63,118,61],[85,6,119,4],[86,4,120,2],[88,4,122,2],[89,4,123,2],[89,10,123,16,"updateChatMetadata"],[89,28,123,34,"updateChatMetadata"],[89,29,124,4,"bookingId"],[89,38,124,21],[89,40,125,4,"lastMessage"],[89,51,125,23],[89,53,126,4,"senderType"],[89,63,126,43],[89,65,127,19],[90,6,128,4],[90,10,128,8],[91,8,129,6],[91,14,129,12,"metadataRef"],[91,25,129,23],[91,28,129,26],[91,32,129,26,"ref"],[91,49,129,29],[91,50,129,29,"ref"],[91,53,129,29],[91,55,129,30,"database"],[91,70,129,38],[91,71,129,38,"database"],[91,79,129,38],[91,81,129,40],[91,90,129,49,"bookingId"],[91,99,129,58],[91,110,129,69],[91,111,129,70],[92,8,130,6],[92,14,130,12,"snapshot"],[92,22,130,20],[92,25,130,23],[92,31,130,29],[92,35,130,29,"get"],[92,52,130,32],[92,53,130,32,"get"],[92,56,130,32],[92,58,130,33,"metadataRef"],[92,69,130,44],[92,70,130,45],[93,8,131,6],[93,14,131,12,"currentMetadata"],[93,29,131,27],[93,32,131,30,"snapshot"],[93,40,131,38],[93,41,131,39,"val"],[93,44,131,42],[93,45,131,43],[93,46,131,44],[93,50,131,48],[93,51,131,49],[93,52,131,50],[94,8,133,6],[94,14,133,12,"updates"],[94,21,133,19],[94,24,133,22],[95,10,134,8,"lastMessage"],[95,21,134,19],[95,23,134,21,"lastMessage"],[95,34,134,32],[95,35,134,33,"substring"],[95,44,134,42],[95,45,134,43],[95,46,134,44],[95,48,134,46],[95,51,134,49],[95,52,134,50],[96,10,135,8,"lastMessageTimestamp"],[96,30,135,28],[96,32,135,30,"Date"],[96,36,135,34],[96,37,135,35,"now"],[96,40,135,38],[96,41,135,39],[97,8,136,6],[97,9,136,7],[99,8,138,6],[100,8,139,6],[100,12,139,10,"senderType"],[100,22,139,20],[100,27,139,25],[100,37,139,35],[100,39,139,37],[101,10,140,8,"updates"],[101,17,140,15],[101,18,140,16],[101,43,140,41],[101,44,140,42],[101,47,140,45],[101,48,140,46,"currentMetadata"],[101,63,140,61],[101,64,140,62,"unreadCountProfessional"],[101,87,140,85],[101,91,140,89],[101,92,140,90],[101,96,140,94],[101,97,140,95],[102,8,141,6],[102,9,141,7],[102,15,141,13],[103,10,142,8,"updates"],[103,17,142,15],[103,18,142,16],[103,39,142,37],[103,40,142,38],[103,43,142,41],[103,44,142,42,"currentMetadata"],[103,59,142,57],[103,60,142,58,"unreadCountCustomer"],[103,79,142,77],[103,83,142,81],[103,84,142,82],[103,88,142,86],[103,89,142,87],[104,8,143,6],[105,8,145,6],[105,14,145,12],[105,18,145,12,"set"],[105,35,145,15],[105,36,145,15,"set"],[105,39,145,15],[105,41,145,16,"metadataRef"],[105,52,145,27],[105,54,145,27,"Object"],[105,60,145,27],[105,61,145,27,"assign"],[105,67,145,27],[105,72,145,34,"currentMetadata"],[105,87,145,49],[105,89,145,54,"updates"],[105,96,145,61],[105,97,145,63],[105,98,145,64],[106,6,146,4],[106,7,146,5],[106,8,146,6],[106,15,146,13,"error"],[106,20,146,18],[106,22,146,20],[107,8,147,6,"console"],[107,15,147,13],[107,16,147,14,"error"],[107,21,147,19],[107,22,147,20],[107,53,147,51],[107,55,147,53,"error"],[107,60,147,58],[107,61,147,59],[108,6,148,4],[109,4,149,2],[111,4,151,2],[112,4,152,2],[112,10,152,8,"initializeChatMetadata"],[112,32,152,30,"initializeChatMetadata"],[112,33,153,4,"bookingId"],[112,42,153,21],[112,44,154,4,"customerId"],[112,54,154,22],[112,56,155,4,"customerName"],[112,68,155,24],[112,70,156,4,"professionalId"],[112,84,156,26],[112,86,157,4,"professionalName"],[112,102,157,28],[112,104,158,19],[113,6,159,4],[113,10,159,8],[114,8,160,6],[114,14,160,12,"metadataRef"],[114,25,160,23],[114,28,160,26],[114,32,160,26,"ref"],[114,49,160,29],[114,50,160,29,"ref"],[114,53,160,29],[114,55,160,30,"database"],[114,70,160,38],[114,71,160,38,"database"],[114,79,160,38],[114,81,160,40],[114,90,160,49,"bookingId"],[114,99,160,58],[114,110,160,69],[114,111,160,70],[115,8,161,6],[115,14,161,12,"snapshot"],[115,22,161,20],[115,25,161,23],[115,31,161,29],[115,35,161,29,"get"],[115,52,161,32],[115,53,161,32,"get"],[115,56,161,32],[115,58,161,33,"metadataRef"],[115,69,161,44],[115,70,161,45],[116,8,163,6],[116,12,163,10],[116,13,163,11,"snapshot"],[116,21,163,19],[116,22,163,20,"exists"],[116,28,163,26],[116,29,163,27],[116,30,163,28],[116,32,163,30],[117,10,164,8],[117,16,164,14,"metadata"],[117,24,164,36],[117,27,164,39],[118,12,165,10,"bookingId"],[118,21,165,19],[119,12,166,10,"customerId"],[119,22,166,20],[120,12,167,10,"customerName"],[120,24,167,22],[121,12,168,10,"professionalId"],[121,26,168,24],[122,12,169,10,"professionalName"],[122,28,169,26],[123,12,170,10,"lastMessage"],[123,23,170,21],[123,25,170,23],[123,27,170,25],[124,12,171,10,"lastMessageTimestamp"],[124,32,171,30],[124,34,171,32,"Date"],[124,38,171,36],[124,39,171,37,"now"],[124,42,171,40],[124,43,171,41],[124,44,171,42],[125,12,172,10,"unreadCountCustomer"],[125,31,172,29],[125,33,172,31],[125,34,172,32],[126,12,173,10,"unreadCountProfessional"],[126,35,173,33],[126,37,173,35],[127,10,174,8],[127,11,174,9],[128,10,175,8],[128,16,175,14],[128,20,175,14,"set"],[128,37,175,17],[128,38,175,17,"set"],[128,41,175,17],[128,43,175,18,"metadataRef"],[128,54,175,29],[128,56,175,31,"metadata"],[128,64,175,39],[128,65,175,40],[129,8,176,6],[130,6,177,4],[130,7,177,5],[130,8,177,6],[130,15,177,13,"error"],[130,20,177,18],[130,22,177,20],[131,8,178,6,"console"],[131,15,178,13],[131,16,178,14,"error"],[131,21,178,19],[131,22,178,20],[131,57,178,55],[131,59,178,57,"error"],[131,64,178,62],[131,65,178,63],[132,6,179,4],[133,4,180,2],[135,4,182,2],[136,4,183,2],[136,10,183,8,"getUnreadCount"],[136,24,183,22,"getUnreadCount"],[136,25,183,23,"bookingId"],[136,34,183,40],[136,36,183,42,"userType"],[136,44,183,79],[136,46,183,98],[137,6,184,4],[137,10,184,8],[138,8,185,6],[138,14,185,12,"field"],[138,19,185,17],[138,22,185,20,"userType"],[138,30,185,28],[138,35,185,33],[138,45,185,43],[138,48,185,46],[138,69,185,67],[138,72,185,70],[138,97,185,95],[139,8,186,6],[139,14,186,12,"unreadRef"],[139,23,186,21],[139,26,186,24],[139,30,186,24,"ref"],[139,47,186,27],[139,48,186,27,"ref"],[139,51,186,27],[139,53,186,28,"database"],[139,68,186,36],[139,69,186,36,"database"],[139,77,186,36],[139,79,186,38],[139,88,186,47,"bookingId"],[139,97,186,56],[139,110,186,69,"field"],[139,115,186,74],[139,117,186,76],[139,118,186,77],[140,8,187,6],[140,14,187,12,"snapshot"],[140,22,187,20],[140,25,187,23],[140,31,187,29],[140,35,187,29,"get"],[140,52,187,32],[140,53,187,32,"get"],[140,56,187,32],[140,58,187,33,"unreadRef"],[140,67,187,42],[140,68,187,43],[141,8,188,6],[141,15,188,13,"snapshot"],[141,23,188,21],[141,24,188,22,"val"],[141,27,188,25],[141,28,188,26],[141,29,188,27],[141,33,188,31],[141,34,188,32],[142,6,189,4],[142,7,189,5],[142,8,189,6],[142,15,189,13,"error"],[142,20,189,18],[142,22,189,20],[143,8,190,6,"console"],[143,15,190,13],[143,16,190,14,"error"],[143,21,190,19],[143,22,190,20],[143,51,190,49],[143,53,190,51,"error"],[143,58,190,56],[143,59,190,57],[144,8,191,6],[144,15,191,13],[144,16,191,14],[145,6,192,4],[146,4,193,2],[148,4,195,2],[149,4,196,2],[149,10,196,8,"getUserChats"],[149,22,196,20,"getUserChats"],[149,23,196,21,"userId"],[149,29,196,35],[149,31,196,37,"userType"],[149,39,196,74],[149,41,196,101],[150,6,197,4],[150,10,197,8],[151,8,198,6],[151,14,198,12,"chatsRef"],[151,22,198,20],[151,25,198,23],[151,29,198,23,"ref"],[151,46,198,26],[151,47,198,26,"ref"],[151,50,198,26],[151,52,198,27,"database"],[151,67,198,35],[151,68,198,35,"database"],[151,76,198,35],[151,78,198,37],[151,85,198,44],[151,86,198,45],[152,8,199,6],[152,14,199,12,"snapshot"],[152,22,199,20],[152,25,199,23],[152,31,199,29],[152,35,199,29,"get"],[152,52,199,32],[152,53,199,32,"get"],[152,56,199,32],[152,58,199,33,"chatsRef"],[152,66,199,41],[152,67,199,42],[153,8,200,6],[153,14,200,12,"chats"],[153,19,200,33],[153,22,200,36],[153,24,200,38],[154,8,202,6,"snapshot"],[154,16,202,14],[154,17,202,15,"forEach"],[154,24,202,22],[154,25,202,24,"childSnapshot"],[154,38,202,37],[154,42,202,42],[155,10,203,8],[155,16,203,14,"metadata"],[155,24,203,22],[155,27,203,25,"childSnapshot"],[155,40,203,38],[155,41,203,39,"val"],[155,44,203,42],[155,45,203,43],[155,46,203,44],[155,47,203,45,"metadata"],[155,55,203,53],[156,10,204,8],[156,14,204,12,"metadata"],[156,22,204,20],[156,24,204,22],[157,12,205,10],[157,18,205,16,"isUserChat"],[157,28,205,26],[157,31,206,12,"userType"],[157,39,206,20],[157,44,206,25],[157,54,206,35],[157,57,207,16,"metadata"],[157,65,207,24],[157,66,207,25,"customerId"],[157,76,207,35],[157,81,207,40,"userId"],[157,87,207,46],[157,90,208,16,"metadata"],[157,98,208,24],[157,99,208,25,"professionalId"],[157,113,208,39],[157,118,208,44,"userId"],[157,124,208,50],[158,12,210,10],[158,16,210,14,"isUserChat"],[158,26,210,24],[158,28,210,26],[159,14,211,12,"chats"],[159,19,211,17],[159,20,211,18,"push"],[159,24,211,22],[159,25,211,23,"metadata"],[159,33,211,31],[159,34,211,32],[160,12,212,10],[161,10,213,8],[162,8,214,6],[162,9,214,7],[162,10,214,8],[164,8,216,6],[165,8,217,6,"chats"],[165,13,217,11],[165,14,217,12,"sort"],[165,18,217,16],[165,19,217,17],[165,20,217,18,"a"],[165,21,217,19],[165,23,217,21,"b"],[165,24,217,22],[165,29,217,27,"b"],[165,30,217,28],[165,31,217,29,"lastMessageTimestamp"],[165,51,217,49],[165,54,217,52,"a"],[165,55,217,53],[165,56,217,54,"lastMessageTimestamp"],[165,76,217,74],[165,77,217,75],[166,8,218,6],[166,15,218,13,"chats"],[166,20,218,18],[167,6,219,4],[167,7,219,5],[167,8,219,6],[167,15,219,13,"error"],[167,20,219,18],[167,22,219,20],[168,8,220,6,"console"],[168,15,220,13],[168,16,220,14,"error"],[168,21,220,19],[168,22,220,20],[168,49,220,47],[168,51,220,49,"error"],[168,56,220,54],[168,57,220,55],[169,8,221,6],[169,15,221,13],[169,17,221,15],[170,6,222,4],[171,4,223,2],[172,2,224,0],[173,2,226,0],[173,6,226,0,"_default"],[173,14,226,0],[173,17,226,15],[173,21,226,19,"ChatService"],[173,32,226,30],[173,33,226,31],[173,34,226,32],[174,0,226,33],[174,3]],"functionMap":{"names":["<global>","ChatService","ChatService#sendMessage","ChatService#listenToMessages","onValue$argument_1","snapshot.forEach$argument_0","<anonymous>","ChatService#markMessagesAsRead","ChatService#updateChatMetadata","ChatService#initializeChatMetadata","ChatService#getUnreadCount","ChatService#getUserChats","chats.sort$argument_0"],"mappings":"AAA;AC0B;ECE;GD2B;EEG;0CCU;uBCE;ODK;KDE;WGG;KHE;GFC;EMG;uBFU;OEM;GNiB;EOG;GP0B;EQG;GR4B;ESG;GTU;EUG;uBNM;OMY;iBCG,yDD;GVM;CDC"},"hasCjsExports":false},"type":"js/module"}]}