{"dependencies":[{"name":"./ring_buffer","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":17,"index":32},"end":{"line":3,"column":41,"index":56}}],"key":"Z/QYm52/JCo8EwOg+ZdzaUofuzE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  var RingBuffer = require(_dependencyMap[0], \"./ring_buffer\");\n  var Pledge = function () {\n    this._complete = false;\n    this._callbacks = new RingBuffer(Pledge.QUEUE_SIZE);\n  };\n  Pledge.QUEUE_SIZE = 4;\n  Pledge.all = function (list) {\n    var pledge = new Pledge(),\n      pending = list.length,\n      n = pending;\n    if (pending === 0) pledge.done();\n    while (n--) list[n].then(function () {\n      pending -= 1;\n      if (pending === 0) pledge.done();\n    });\n    return pledge;\n  };\n  Pledge.prototype.then = function (callback) {\n    if (this._complete) callback();else this._callbacks.push(callback);\n  };\n  Pledge.prototype.done = function () {\n    this._complete = true;\n    var callbacks = this._callbacks,\n      callback;\n    while (callback = callbacks.shift()) callback();\n  };\n  module.exports = Pledge;\n});","lineCount":31,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0],[4,6,3,4,"RingBuffer"],[4,16,3,14],[4,19,3,17,"require"],[4,26,3,24],[4,27,3,24,"_dependencyMap"],[4,41,3,24],[4,61,3,40],[4,62,3,41],[5,2,5,0],[5,6,5,4,"Pledge"],[5,12,5,10],[5,15,5,13],[5,24,5,13,"Pledge"],[5,25,5,13],[5,27,5,24],[6,4,6,2],[6,8,6,6],[6,9,6,7,"_complete"],[6,18,6,16],[6,21,6,20],[6,26,6,25],[7,4,7,2],[7,8,7,6],[7,9,7,7,"_callbacks"],[7,19,7,17],[7,22,7,20],[7,26,7,24,"RingBuffer"],[7,36,7,34],[7,37,7,35,"Pledge"],[7,43,7,41],[7,44,7,42,"QUEUE_SIZE"],[7,54,7,52],[7,55,7,53],[8,2,8,0],[8,3,8,1],[9,2,10,0,"Pledge"],[9,8,10,6],[9,9,10,7,"QUEUE_SIZE"],[9,19,10,17],[9,22,10,20],[9,23,10,21],[10,2,12,0,"Pledge"],[10,8,12,6],[10,9,12,7,"all"],[10,12,12,10],[10,15,12,13],[10,25,12,22,"list"],[10,29,12,26],[10,31,12,28],[11,4,13,2],[11,8,13,6,"pledge"],[11,14,13,12],[11,17,13,16],[11,21,13,20,"Pledge"],[11,27,13,26],[11,28,13,27],[11,29,13,28],[12,6,14,6,"pending"],[12,13,14,13],[12,16,14,16,"list"],[12,20,14,20],[12,21,14,21,"length"],[12,27,14,27],[13,6,15,6,"n"],[13,7,15,7],[13,10,15,16,"pending"],[13,17,15,23],[14,4,17,2],[14,8,17,6,"pending"],[14,15,17,13],[14,20,17,18],[14,21,17,19],[14,23,17,21,"pledge"],[14,29,17,27],[14,30,17,28,"done"],[14,34,17,32],[14,35,17,33],[14,36,17,34],[15,4,19,2],[15,11,19,9,"n"],[15,12,19,10],[15,14,19,12],[15,16,19,14,"list"],[15,20,19,18],[15,21,19,19,"n"],[15,22,19,20],[15,23,19,21],[15,24,19,22,"then"],[15,28,19,26],[15,29,19,27],[15,41,19,38],[16,6,20,4,"pending"],[16,13,20,11],[16,17,20,15],[16,18,20,16],[17,6,21,4],[17,10,21,8,"pending"],[17,17,21,15],[17,22,21,20],[17,23,21,21],[17,25,21,23,"pledge"],[17,31,21,29],[17,32,21,30,"done"],[17,36,21,34],[17,37,21,35],[17,38,21,36],[18,4,22,2],[18,5,22,3],[18,6,22,4],[19,4,23,2],[19,11,23,9,"pledge"],[19,17,23,15],[20,2,24,0],[20,3,24,1],[21,2,26,0,"Pledge"],[21,8,26,6],[21,9,26,7,"prototype"],[21,18,26,16],[21,19,26,17,"then"],[21,23,26,21],[21,26,26,24],[21,36,26,33,"callback"],[21,44,26,41],[21,46,26,43],[22,4,27,2],[22,8,27,6],[22,12,27,10],[22,13,27,11,"_complete"],[22,22,27,20],[22,24,27,22,"callback"],[22,32,27,30],[22,33,27,31],[22,34,27,32],[22,35,27,33],[22,40,28,7],[22,44,28,11],[22,45,28,12,"_callbacks"],[22,55,28,22],[22,56,28,23,"push"],[22,60,28,27],[22,61,28,28,"callback"],[22,69,28,36],[22,70,28,37],[23,2,29,0],[23,3,29,1],[24,2,31,0,"Pledge"],[24,8,31,6],[24,9,31,7,"prototype"],[24,18,31,16],[24,19,31,17,"done"],[24,23,31,21],[24,26,31,24],[24,38,31,35],[25,4,32,2],[25,8,32,6],[25,9,32,7,"_complete"],[25,18,32,16],[25,21,32,19],[25,25,32,23],[26,4,33,2],[26,8,33,6,"callbacks"],[26,17,33,15],[26,20,33,18],[26,24,33,22],[26,25,33,23,"_callbacks"],[26,35,33,33],[27,6,33,35,"callback"],[27,14,33,43],[28,4,34,2],[28,11,34,9,"callback"],[28,19,34,17],[28,22,34,20,"callbacks"],[28,31,34,29],[28,32,34,30,"shift"],[28,37,34,35],[28,38,34,36],[28,39,34,37],[28,41,34,39,"callback"],[28,49,34,47],[28,50,34,48],[28,51,34,49],[29,2,35,0],[29,3,35,1],[30,2,37,0,"module"],[30,8,37,6],[30,9,37,7,"exports"],[30,16,37,14],[30,19,37,17,"Pledge"],[30,25,37,23],[31,0,37,24],[31,3]],"functionMap":{"names":["<global>","Pledge","Pledge.all","list.n.then$argument_0","Pledge.prototype.then","Pledge.prototype.done"],"mappings":"AAA;aCI;CDG;aEI;2BCO;GDG;CFE;wBIE;CJG;wBKE;CLI"},"hasCjsExports":true},"type":"js/module"}]}