{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/classCallCheck","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"yg7e6laZwmpbIvId5jovq9ugXp8=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/createClass","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"Z6pzkVZ2fvxBLkFTgVVOy4UDj30=","exportNames":["*"],"imports":1}},{"name":"../config/firebase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"K/SZPG5sPeV1upVh8dao26aG7MQ=","exportNames":["*"],"imports":1}},{"name":"firebase/database","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":47},"end":{"line":2,"column":104,"index":151}}],"key":"ZF/J3nfk5GUgbzXl84BqV1IxYEE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _babelRuntimeHelpersClassCallCheck = require(_dependencyMap[1], \"@babel/runtime/helpers/classCallCheck\");\n  var _classCallCheck = _interopDefault(_babelRuntimeHelpersClassCallCheck);\n  var _babelRuntimeHelpersCreateClass = require(_dependencyMap[2], \"@babel/runtime/helpers/createClass\");\n  var _createClass = _interopDefault(_babelRuntimeHelpersCreateClass);\n  var _configFirebase = require(_dependencyMap[3], \"../config/firebase\");\n  var _firebaseDatabase = require(_dependencyMap[4], \"firebase/database\");\n  var ChatService = /*#__PURE__*/function () {\n    function ChatService() {\n      (0, _classCallCheck.default)(this, ChatService);\n    }\n    return (0, _createClass.default)(ChatService, [{\n      key: \"sendMessage\",\n      value: // Send a message\n      function () {\n        var _sendMessage = (0, _asyncToGenerator.default)(function* (bookingId, senderId, senderName, senderType, message) {\n          try {\n            var messagesRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/messages`);\n            var newMessage = {\n              bookingId,\n              senderId,\n              senderName,\n              senderType,\n              message,\n              timestamp: Date.now(),\n              read: false\n            };\n            yield (0, _firebaseDatabase.push)(messagesRef, newMessage);\n\n            // Update chat metadata\n            yield this.updateChatMetadata(bookingId, message, senderType);\n          } catch (error) {\n            console.error('Error sending message:', error);\n            throw error;\n          }\n        });\n        function sendMessage(_x, _x2, _x3, _x4, _x5) {\n          return _sendMessage.apply(this, arguments);\n        }\n        return sendMessage;\n      }() // Listen to messages in real-time\n    }, {\n      key: \"listenToMessages\",\n      value: function listenToMessages(bookingId, callback) {\n        var messagesRef = (0, _firebaseDatabase.query)((0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/messages`), (0, _firebaseDatabase.orderByChild)('timestamp'), (0, _firebaseDatabase.limitToLast)(100));\n        var listener = (0, _firebaseDatabase.onValue)(messagesRef, snapshot => {\n          var messages = [];\n          snapshot.forEach(childSnapshot => {\n            messages.push({\n              id: childSnapshot.key || undefined,\n              ...childSnapshot.val()\n            });\n          });\n          callback(messages);\n        });\n\n        // Return cleanup function\n        return () => {\n          (0, _firebaseDatabase.off)(messagesRef);\n        };\n      }\n\n      // Mark messages as read\n    }, {\n      key: \"markMessagesAsRead\",\n      value: function () {\n        var _markMessagesAsRead = (0, _asyncToGenerator.default)(function* (bookingId, userId, userType) {\n          try {\n            var messagesRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/messages`);\n            var snapshot = yield (0, _firebaseDatabase.get)(messagesRef);\n            var updates = {};\n            snapshot.forEach(childSnapshot => {\n              var message = childSnapshot.val();\n              // Mark as read if the message is from the other party\n              if (message.senderId !== userId && !message.read) {\n                updates[`${childSnapshot.key}/read`] = true;\n              }\n            });\n            if (Object.keys(updates).length > 0) {\n              var messagesRefWithUpdates = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/messages`);\n              yield (0, _firebaseDatabase.set)(messagesRefWithUpdates, updates);\n            }\n\n            // Reset unread count\n            var metadataRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata`);\n            if (userType === 'customer') {\n              yield (0, _firebaseDatabase.set)((0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata/unreadCountCustomer`), 0);\n            } else {\n              yield (0, _firebaseDatabase.set)((0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata/unreadCountProfessional`), 0);\n            }\n          } catch (error) {\n            console.error('Error marking messages as read:', error);\n          }\n        });\n        function markMessagesAsRead(_x6, _x7, _x8) {\n          return _markMessagesAsRead.apply(this, arguments);\n        }\n        return markMessagesAsRead;\n      }() // Update chat metadata\n    }, {\n      key: \"updateChatMetadata\",\n      value: function () {\n        var _updateChatMetadata = (0, _asyncToGenerator.default)(function* (bookingId, lastMessage, senderType) {\n          try {\n            var metadataRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata`);\n            var snapshot = yield (0, _firebaseDatabase.get)(metadataRef);\n            var currentMetadata = snapshot.val() || {};\n            var updates = {\n              lastMessage: lastMessage.substring(0, 100),\n              lastMessageTimestamp: Date.now()\n            };\n\n            // Increment unread count for the receiver\n            if (senderType === 'customer') {\n              updates['unreadCountProfessional'] = (currentMetadata.unreadCountProfessional || 0) + 1;\n            } else {\n              updates['unreadCountCustomer'] = (currentMetadata.unreadCountCustomer || 0) + 1;\n            }\n            yield (0, _firebaseDatabase.set)(metadataRef, {\n              ...currentMetadata,\n              ...updates\n            });\n          } catch (error) {\n            console.error('Error updating chat metadata:', error);\n          }\n        });\n        function updateChatMetadata(_x9, _x0, _x1) {\n          return _updateChatMetadata.apply(this, arguments);\n        }\n        return updateChatMetadata;\n      }() // Initialize chat metadata\n    }, {\n      key: \"initializeChatMetadata\",\n      value: function () {\n        var _initializeChatMetadata = (0, _asyncToGenerator.default)(function* (bookingId, customerId, customerName, professionalId, professionalName) {\n          try {\n            var metadataRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata`);\n            var snapshot = yield (0, _firebaseDatabase.get)(metadataRef);\n            if (!snapshot.exists()) {\n              var metadata = {\n                bookingId,\n                customerId,\n                customerName,\n                professionalId,\n                professionalName,\n                lastMessage: '',\n                lastMessageTimestamp: Date.now(),\n                unreadCountCustomer: 0,\n                unreadCountProfessional: 0\n              };\n              yield (0, _firebaseDatabase.set)(metadataRef, metadata);\n            }\n          } catch (error) {\n            console.error('Error initializing chat metadata:', error);\n          }\n        });\n        function initializeChatMetadata(_x10, _x11, _x12, _x13, _x14) {\n          return _initializeChatMetadata.apply(this, arguments);\n        }\n        return initializeChatMetadata;\n      }() // Get unread count\n    }, {\n      key: \"getUnreadCount\",\n      value: function () {\n        var _getUnreadCount = (0, _asyncToGenerator.default)(function* (bookingId, userType) {\n          try {\n            var field = userType === 'customer' ? 'unreadCountCustomer' : 'unreadCountProfessional';\n            var unreadRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata/${field}`);\n            var snapshot = yield (0, _firebaseDatabase.get)(unreadRef);\n            return snapshot.val() || 0;\n          } catch (error) {\n            console.error('Error getting unread count:', error);\n            return 0;\n          }\n        });\n        function getUnreadCount(_x15, _x16) {\n          return _getUnreadCount.apply(this, arguments);\n        }\n        return getUnreadCount;\n      }() // Get all chats for a user\n    }, {\n      key: \"getUserChats\",\n      value: function () {\n        var _getUserChats = (0, _asyncToGenerator.default)(function* (userId, userType) {\n          try {\n            var chatsRef = (0, _firebaseDatabase.ref)(_configFirebase.database, 'chats');\n            var snapshot = yield (0, _firebaseDatabase.get)(chatsRef);\n            var chats = [];\n            snapshot.forEach(childSnapshot => {\n              var metadata = childSnapshot.val().metadata;\n              if (metadata) {\n                var isUserChat = userType === 'customer' ? metadata.customerId === userId : metadata.professionalId === userId;\n                if (isUserChat) {\n                  chats.push(metadata);\n                }\n              }\n            });\n\n            // Sort by last message timestamp\n            chats.sort((a, b) => b.lastMessageTimestamp - a.lastMessageTimestamp);\n            return chats;\n          } catch (error) {\n            console.error('Error getting user chats:', error);\n            return [];\n          }\n        });\n        function getUserChats(_x17, _x18) {\n          return _getUserChats.apply(this, arguments);\n        }\n        return getUserChats;\n      }()\n    }]);\n  }();\n  var _default = new ChatService();\n});","lineCount":233,"map":[[12,2,226,0,"Object"],[12,8,226,0],[12,9,226,0,"defineProperty"],[12,23,226,0],[12,24,226,0,"exports"],[12,31,226,0],[13,4,226,0,"enumerable"],[13,14,226,0],[14,4,226,0,"get"],[14,7,226,0],[14,18,226,0,"get"],[14,19,226,0],[15,6,226,0],[15,13,226,0,"_default"],[15,21,226,0],[16,4,226,0],[17,2,226,0],[18,2,226,33],[18,6,226,33,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,226,33],[18,45,226,33,"require"],[18,52,226,33],[18,53,226,33,"_dependencyMap"],[18,67,226,33],[19,2,226,33],[19,6,226,33,"_asyncToGenerator"],[19,23,226,33],[19,26,226,33,"_interopDefault"],[19,41,226,33],[19,42,226,33,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,226,33],[20,2,226,33],[20,6,226,33,"_babelRuntimeHelpersClassCallCheck"],[20,40,226,33],[20,43,226,33,"require"],[20,50,226,33],[20,51,226,33,"_dependencyMap"],[20,65,226,33],[21,2,226,33],[21,6,226,33,"_classCallCheck"],[21,21,226,33],[21,24,226,33,"_interopDefault"],[21,39,226,33],[21,40,226,33,"_babelRuntimeHelpersClassCallCheck"],[21,74,226,33],[22,2,226,33],[22,6,226,33,"_babelRuntimeHelpersCreateClass"],[22,37,226,33],[22,40,226,33,"require"],[22,47,226,33],[22,48,226,33,"_dependencyMap"],[22,62,226,33],[23,2,226,33],[23,6,226,33,"_createClass"],[23,18,226,33],[23,21,226,33,"_interopDefault"],[23,36,226,33],[23,37,226,33,"_babelRuntimeHelpersCreateClass"],[23,68,226,33],[24,2,1,0],[24,6,1,0,"_configFirebase"],[24,21,1,0],[24,24,1,0,"require"],[24,31,1,0],[24,32,1,0,"_dependencyMap"],[24,46,1,0],[25,2,2,0],[25,6,2,0,"_firebaseDatabase"],[25,23,2,0],[25,26,2,0,"require"],[25,33,2,0],[25,34,2,0,"_dependencyMap"],[25,48,2,0],[26,2,2,104],[26,6,27,6,"ChatService"],[26,17,27,17],[27,4,27,17],[27,13,27,17,"ChatService"],[27,25,27,17],[28,6,27,17],[28,10,27,17,"_classCallCheck"],[28,25,27,17],[28,26,27,17,"default"],[28,33,27,17],[28,41,27,17,"ChatService"],[28,52,27,17],[29,4,27,17],[30,4,27,17],[30,15,27,17,"_createClass"],[30,27,27,17],[30,28,27,17,"default"],[30,35,27,17],[30,37,27,17,"ChatService"],[30,48,27,17],[31,6,27,17,"key"],[31,9,27,17],[32,6,27,17,"value"],[32,11,27,17],[32,13,28,2],[33,6,28,2],[34,8,28,2],[34,12,28,2,"_sendMessage"],[34,24,28,2],[34,31,28,2,"_asyncToGenerator"],[34,48,28,2],[34,49,28,2,"default"],[34,56,28,2],[34,58,29,2],[34,69,30,4,"bookingId"],[34,78,30,21],[34,80,31,4,"senderId"],[34,88,31,20],[34,90,32,4,"senderName"],[34,100,32,22],[34,102,33,4,"senderType"],[34,112,33,43],[34,114,34,4,"message"],[34,121,34,19],[34,123,35,19],[35,10,36,4],[35,14,36,8],[36,12,37,6],[36,16,37,12,"messagesRef"],[36,27,37,23],[36,30,37,26],[36,34,37,26,"ref"],[36,51,37,29],[36,52,37,29,"ref"],[36,55,37,29],[36,57,37,30,"database"],[36,72,37,38],[36,73,37,38,"database"],[36,81,37,38],[36,83,37,40],[36,92,37,49,"bookingId"],[36,101,37,58],[36,112,37,69],[36,113,37,70],[37,12,38,6],[37,16,38,12,"newMessage"],[37,26,38,47],[37,29,38,50],[38,14,39,8,"bookingId"],[38,23,39,17],[39,14,40,8,"senderId"],[39,22,40,16],[40,14,41,8,"senderName"],[40,24,41,18],[41,14,42,8,"senderType"],[41,24,42,18],[42,14,43,8,"message"],[42,21,43,15],[43,14,44,8,"timestamp"],[43,23,44,17],[43,25,44,19,"Date"],[43,29,44,23],[43,30,44,24,"now"],[43,33,44,27],[43,34,44,28],[43,35,44,29],[44,14,45,8,"read"],[44,18,45,12],[44,20,45,14],[45,12,46,6],[45,13,46,7],[46,12,48,6],[46,18,48,12],[46,22,48,12,"push"],[46,39,48,16],[46,40,48,16,"push"],[46,44,48,16],[46,46,48,17,"messagesRef"],[46,57,48,28],[46,59,48,30,"newMessage"],[46,69,48,40],[46,70,48,41],[48,12,50,6],[49,12,51,6],[49,18,51,12],[49,22,51,16],[49,23,51,17,"updateChatMetadata"],[49,41,51,35],[49,42,51,36,"bookingId"],[49,51,51,45],[49,53,51,47,"message"],[49,60,51,54],[49,62,51,56,"senderType"],[49,72,51,66],[49,73,51,67],[50,10,52,4],[50,11,52,5],[50,12,52,6],[50,19,52,13,"error"],[50,24,52,18],[50,26,52,20],[51,12,53,6,"console"],[51,19,53,13],[51,20,53,14,"error"],[51,25,53,19],[51,26,53,20],[51,50,53,44],[51,52,53,46,"error"],[51,57,53,51],[51,58,53,52],[52,12,54,6],[52,18,54,12,"error"],[52,23,54,17],[53,10,55,4],[54,8,56,2],[54,9,56,3],[55,8,56,3],[55,17,29,8,"sendMessage"],[55,28,29,19,"sendMessage"],[55,29,29,19,"_x"],[55,31,29,19],[55,33,29,19,"_x2"],[55,36,29,19],[55,38,29,19,"_x3"],[55,41,29,19],[55,43,29,19,"_x4"],[55,46,29,19],[55,48,29,19,"_x5"],[55,51,29,19],[56,10,29,19],[56,17,29,19,"_sendMessage"],[56,29,29,19],[56,30,29,19,"apply"],[56,35,29,19],[56,42,29,19,"arguments"],[56,51,29,19],[57,8,29,19],[58,8,29,19],[58,15,29,8,"sendMessage"],[58,26,29,19],[59,6,29,19],[59,10,58,2],[60,4,58,2],[61,6,58,2,"key"],[61,9,58,2],[62,6,58,2,"value"],[62,11,58,2],[62,13,59,2],[62,22,59,2,"listenToMessages"],[62,38,59,18,"listenToMessages"],[62,39,60,4,"bookingId"],[62,48,60,21],[62,50,61,4,"callback"],[62,58,61,47],[62,60,62,16],[63,8,63,4],[63,12,63,10,"messagesRef"],[63,23,63,21],[63,26,63,24],[63,30,63,24,"query"],[63,47,63,29],[63,48,63,29,"query"],[63,53,63,29],[63,55,64,6],[63,59,64,6,"ref"],[63,76,64,9],[63,77,64,9,"ref"],[63,80,64,9],[63,82,64,10,"database"],[63,97,64,18],[63,98,64,18,"database"],[63,106,64,18],[63,108,64,20],[63,117,64,29,"bookingId"],[63,126,64,38],[63,137,64,49],[63,138,64,50],[63,140,65,6],[63,144,65,6,"orderByChild"],[63,161,65,18],[63,162,65,18,"orderByChild"],[63,174,65,18],[63,176,65,19],[63,187,65,30],[63,188,65,31],[63,190,66,6],[63,194,66,6,"limitToLast"],[63,211,66,17],[63,212,66,17,"limitToLast"],[63,223,66,17],[63,225,66,18],[63,228,66,21],[63,229,67,4],[63,230,67,5],[64,8,69,4],[64,12,69,10,"listener"],[64,20,69,18],[64,23,69,21],[64,27,69,21,"onValue"],[64,44,69,28],[64,45,69,28,"onValue"],[64,52,69,28],[64,54,69,29,"messagesRef"],[64,65,69,40],[64,67,69,43,"snapshot"],[64,75,69,51],[64,79,69,56],[65,10,70,6],[65,14,70,12,"messages"],[65,22,70,35],[65,25,70,38],[65,27,70,40],[66,10,71,6,"snapshot"],[66,18,71,14],[66,19,71,15,"forEach"],[66,26,71,22],[66,27,71,24,"childSnapshot"],[66,40,71,37],[66,44,71,42],[67,12,72,8,"messages"],[67,20,72,16],[67,21,72,17,"push"],[67,25,72,21],[67,26,72,22],[68,14,73,10,"id"],[68,16,73,12],[68,18,73,14,"childSnapshot"],[68,31,73,27],[68,32,73,28,"key"],[68,35,73,31],[68,39,73,35,"undefined"],[68,48,73,44],[69,14,74,10],[69,17,74,13,"childSnapshot"],[69,30,74,26],[69,31,74,27,"val"],[69,34,74,30],[69,35,74,31],[70,12,75,8],[70,13,75,9],[70,14,75,10],[71,10,76,6],[71,11,76,7],[71,12,76,8],[72,10,77,6,"callback"],[72,18,77,14],[72,19,77,15,"messages"],[72,27,77,23],[72,28,77,24],[73,8,78,4],[73,9,78,5],[73,10,78,6],[75,8,80,4],[76,8,81,4],[76,15,81,11],[76,21,81,17],[77,10,82,6],[77,14,82,6,"off"],[77,31,82,9],[77,32,82,9,"off"],[77,35,82,9],[77,37,82,10,"messagesRef"],[77,48,82,21],[77,49,82,22],[78,8,83,4],[78,9,83,5],[79,6,84,2],[81,6,86,2],[82,4,86,2],[83,6,86,2,"key"],[83,9,86,2],[84,6,86,2,"value"],[84,11,86,2],[85,8,86,2],[85,12,86,2,"_markMessagesAsRead"],[85,31,86,2],[85,38,86,2,"_asyncToGenerator"],[85,55,86,2],[85,56,86,2,"default"],[85,63,86,2],[85,65,87,2],[85,76,88,4,"bookingId"],[85,85,88,21],[85,87,89,4,"userId"],[85,93,89,18],[85,95,90,4,"userType"],[85,103,90,41],[85,105,91,19],[86,10,92,4],[86,14,92,8],[87,12,93,6],[87,16,93,12,"messagesRef"],[87,27,93,23],[87,30,93,26],[87,34,93,26,"ref"],[87,51,93,29],[87,52,93,29,"ref"],[87,55,93,29],[87,57,93,30,"database"],[87,72,93,38],[87,73,93,38,"database"],[87,81,93,38],[87,83,93,40],[87,92,93,49,"bookingId"],[87,101,93,58],[87,112,93,69],[87,113,93,70],[88,12,94,6],[88,16,94,12,"snapshot"],[88,24,94,20],[88,33,94,29],[88,37,94,29,"get"],[88,54,94,32],[88,55,94,32,"get"],[88,58,94,32],[88,60,94,33,"messagesRef"],[88,71,94,44],[88,72,94,45],[89,12,96,6],[89,16,96,12,"updates"],[89,23,96,43],[89,26,96,46],[89,27,96,47],[89,28,96,48],[90,12,97,6,"snapshot"],[90,20,97,14],[90,21,97,15,"forEach"],[90,28,97,22],[90,29,97,24,"childSnapshot"],[90,42,97,37],[90,46,97,42],[91,14,98,8],[91,18,98,14,"message"],[91,25,98,21],[91,28,98,24,"childSnapshot"],[91,41,98,37],[91,42,98,38,"val"],[91,45,98,41],[91,46,98,42],[91,47,98,43],[92,14,99,8],[93,14,100,8],[93,18,100,12,"message"],[93,25,100,19],[93,26,100,20,"senderId"],[93,34,100,28],[93,39,100,33,"userId"],[93,45,100,39],[93,49,100,43],[93,50,100,44,"message"],[93,57,100,51],[93,58,100,52,"read"],[93,62,100,56],[93,64,100,58],[94,16,101,10,"updates"],[94,23,101,17],[94,24,101,18],[94,27,101,21,"childSnapshot"],[94,40,101,34],[94,41,101,35,"key"],[94,44,101,38],[94,51,101,45],[94,52,101,46],[94,55,101,49],[94,59,101,53],[95,14,102,8],[96,12,103,6],[96,13,103,7],[96,14,103,8],[97,12,105,6],[97,16,105,10,"Object"],[97,22,105,16],[97,23,105,17,"keys"],[97,27,105,21],[97,28,105,22,"updates"],[97,35,105,29],[97,36,105,30],[97,37,105,31,"length"],[97,43,105,37],[97,46,105,40],[97,47,105,41],[97,49,105,43],[98,14,106,8],[98,18,106,14,"messagesRefWithUpdates"],[98,40,106,36],[98,43,106,39],[98,47,106,39,"ref"],[98,64,106,42],[98,65,106,42,"ref"],[98,68,106,42],[98,70,106,43,"database"],[98,85,106,51],[98,86,106,51,"database"],[98,94,106,51],[98,96,106,53],[98,105,106,62,"bookingId"],[98,114,106,71],[98,125,106,82],[98,126,106,83],[99,14,107,8],[99,20,107,14],[99,24,107,14,"set"],[99,41,107,17],[99,42,107,17,"set"],[99,45,107,17],[99,47,107,18,"messagesRefWithUpdates"],[99,69,107,40],[99,71,107,42,"updates"],[99,78,107,49],[99,79,107,50],[100,12,108,6],[102,12,110,6],[103,12,111,6],[103,16,111,12,"metadataRef"],[103,27,111,23],[103,30,111,26],[103,34,111,26,"ref"],[103,51,111,29],[103,52,111,29,"ref"],[103,55,111,29],[103,57,111,30,"database"],[103,72,111,38],[103,73,111,38,"database"],[103,81,111,38],[103,83,111,40],[103,92,111,49,"bookingId"],[103,101,111,58],[103,112,111,69],[103,113,111,70],[104,12,112,6],[104,16,112,10,"userType"],[104,24,112,18],[104,29,112,23],[104,39,112,33],[104,41,112,35],[105,14,113,8],[105,20,113,14],[105,24,113,14,"set"],[105,41,113,17],[105,42,113,17,"set"],[105,45,113,17],[105,47,113,18],[105,51,113,18,"ref"],[105,68,113,21],[105,69,113,21,"ref"],[105,72,113,21],[105,74,113,22,"database"],[105,89,113,30],[105,90,113,30,"database"],[105,98,113,30],[105,100,113,32],[105,109,113,41,"bookingId"],[105,118,113,50],[105,149,113,81],[105,150,113,82],[105,152,113,84],[105,153,113,85],[105,154,113,86],[106,12,114,6],[106,13,114,7],[106,19,114,13],[107,14,115,8],[107,20,115,14],[107,24,115,14,"set"],[107,41,115,17],[107,42,115,17,"set"],[107,45,115,17],[107,47,115,18],[107,51,115,18,"ref"],[107,68,115,21],[107,69,115,21,"ref"],[107,72,115,21],[107,74,115,22,"database"],[107,89,115,30],[107,90,115,30,"database"],[107,98,115,30],[107,100,115,32],[107,109,115,41,"bookingId"],[107,118,115,50],[107,153,115,85],[107,154,115,86],[107,156,115,88],[107,157,115,89],[107,158,115,90],[108,12,116,6],[109,10,117,4],[109,11,117,5],[109,12,117,6],[109,19,117,13,"error"],[109,24,117,18],[109,26,117,20],[110,12,118,6,"console"],[110,19,118,13],[110,20,118,14,"error"],[110,25,118,19],[110,26,118,20],[110,59,118,53],[110,61,118,55,"error"],[110,66,118,60],[110,67,118,61],[111,10,119,4],[112,8,120,2],[112,9,120,3],[113,8,120,3],[113,17,87,8,"markMessagesAsRead"],[113,35,87,26,"markMessagesAsRead"],[113,36,87,26,"_x6"],[113,39,87,26],[113,41,87,26,"_x7"],[113,44,87,26],[113,46,87,26,"_x8"],[113,49,87,26],[114,10,87,26],[114,17,87,26,"_markMessagesAsRead"],[114,36,87,26],[114,37,87,26,"apply"],[114,42,87,26],[114,49,87,26,"arguments"],[114,58,87,26],[115,8,87,26],[116,8,87,26],[116,15,87,8,"markMessagesAsRead"],[116,33,87,26],[117,6,87,26],[117,10,122,2],[118,4,122,2],[119,6,122,2,"key"],[119,9,122,2],[120,6,122,2,"value"],[120,11,122,2],[121,8,122,2],[121,12,122,2,"_updateChatMetadata"],[121,31,122,2],[121,38,122,2,"_asyncToGenerator"],[121,55,122,2],[121,56,122,2,"default"],[121,63,122,2],[121,65,123,2],[121,76,124,4,"bookingId"],[121,85,124,21],[121,87,125,4,"lastMessage"],[121,98,125,23],[121,100,126,4,"senderType"],[121,110,126,43],[121,112,127,19],[122,10,128,4],[122,14,128,8],[123,12,129,6],[123,16,129,12,"metadataRef"],[123,27,129,23],[123,30,129,26],[123,34,129,26,"ref"],[123,51,129,29],[123,52,129,29,"ref"],[123,55,129,29],[123,57,129,30,"database"],[123,72,129,38],[123,73,129,38,"database"],[123,81,129,38],[123,83,129,40],[123,92,129,49,"bookingId"],[123,101,129,58],[123,112,129,69],[123,113,129,70],[124,12,130,6],[124,16,130,12,"snapshot"],[124,24,130,20],[124,33,130,29],[124,37,130,29,"get"],[124,54,130,32],[124,55,130,32,"get"],[124,58,130,32],[124,60,130,33,"metadataRef"],[124,71,130,44],[124,72,130,45],[125,12,131,6],[125,16,131,12,"currentMetadata"],[125,31,131,27],[125,34,131,30,"snapshot"],[125,42,131,38],[125,43,131,39,"val"],[125,46,131,42],[125,47,131,43],[125,48,131,44],[125,52,131,48],[125,53,131,49],[125,54,131,50],[126,12,133,6],[126,16,133,12,"updates"],[126,23,133,19],[126,26,133,22],[127,14,134,8,"lastMessage"],[127,25,134,19],[127,27,134,21,"lastMessage"],[127,38,134,32],[127,39,134,33,"substring"],[127,48,134,42],[127,49,134,43],[127,50,134,44],[127,52,134,46],[127,55,134,49],[127,56,134,50],[128,14,135,8,"lastMessageTimestamp"],[128,34,135,28],[128,36,135,30,"Date"],[128,40,135,34],[128,41,135,35,"now"],[128,44,135,38],[128,45,135,39],[129,12,136,6],[129,13,136,7],[131,12,138,6],[132,12,139,6],[132,16,139,10,"senderType"],[132,26,139,20],[132,31,139,25],[132,41,139,35],[132,43,139,37],[133,14,140,8,"updates"],[133,21,140,15],[133,22,140,16],[133,47,140,41],[133,48,140,42],[133,51,140,45],[133,52,140,46,"currentMetadata"],[133,67,140,61],[133,68,140,62,"unreadCountProfessional"],[133,91,140,85],[133,95,140,89],[133,96,140,90],[133,100,140,94],[133,101,140,95],[134,12,141,6],[134,13,141,7],[134,19,141,13],[135,14,142,8,"updates"],[135,21,142,15],[135,22,142,16],[135,43,142,37],[135,44,142,38],[135,47,142,41],[135,48,142,42,"currentMetadata"],[135,63,142,57],[135,64,142,58,"unreadCountCustomer"],[135,83,142,77],[135,87,142,81],[135,88,142,82],[135,92,142,86],[135,93,142,87],[136,12,143,6],[137,12,145,6],[137,18,145,12],[137,22,145,12,"set"],[137,39,145,15],[137,40,145,15,"set"],[137,43,145,15],[137,45,145,16,"metadataRef"],[137,56,145,27],[137,58,145,29],[138,14,145,31],[138,17,145,34,"currentMetadata"],[138,32,145,49],[139,14,145,51],[139,17,145,54,"updates"],[140,12,145,62],[140,13,145,63],[140,14,145,64],[141,10,146,4],[141,11,146,5],[141,12,146,6],[141,19,146,13,"error"],[141,24,146,18],[141,26,146,20],[142,12,147,6,"console"],[142,19,147,13],[142,20,147,14,"error"],[142,25,147,19],[142,26,147,20],[142,57,147,51],[142,59,147,53,"error"],[142,64,147,58],[142,65,147,59],[143,10,148,4],[144,8,149,2],[144,9,149,3],[145,8,149,3],[145,17,123,16,"updateChatMetadata"],[145,35,123,34,"updateChatMetadata"],[145,36,123,34,"_x9"],[145,39,123,34],[145,41,123,34,"_x0"],[145,44,123,34],[145,46,123,34,"_x1"],[145,49,123,34],[146,10,123,34],[146,17,123,34,"_updateChatMetadata"],[146,36,123,34],[146,37,123,34,"apply"],[146,42,123,34],[146,49,123,34,"arguments"],[146,58,123,34],[147,8,123,34],[148,8,123,34],[148,15,123,16,"updateChatMetadata"],[148,33,123,34],[149,6,123,34],[149,10,151,2],[150,4,151,2],[151,6,151,2,"key"],[151,9,151,2],[152,6,151,2,"value"],[152,11,151,2],[153,8,151,2],[153,12,151,2,"_initializeChatMetadata"],[153,35,151,2],[153,42,151,2,"_asyncToGenerator"],[153,59,151,2],[153,60,151,2,"default"],[153,67,151,2],[153,69,152,2],[153,80,153,4,"bookingId"],[153,89,153,21],[153,91,154,4,"customerId"],[153,101,154,22],[153,103,155,4,"customerName"],[153,115,155,24],[153,117,156,4,"professionalId"],[153,131,156,26],[153,133,157,4,"professionalName"],[153,149,157,28],[153,151,158,19],[154,10,159,4],[154,14,159,8],[155,12,160,6],[155,16,160,12,"metadataRef"],[155,27,160,23],[155,30,160,26],[155,34,160,26,"ref"],[155,51,160,29],[155,52,160,29,"ref"],[155,55,160,29],[155,57,160,30,"database"],[155,72,160,38],[155,73,160,38,"database"],[155,81,160,38],[155,83,160,40],[155,92,160,49,"bookingId"],[155,101,160,58],[155,112,160,69],[155,113,160,70],[156,12,161,6],[156,16,161,12,"snapshot"],[156,24,161,20],[156,33,161,29],[156,37,161,29,"get"],[156,54,161,32],[156,55,161,32,"get"],[156,58,161,32],[156,60,161,33,"metadataRef"],[156,71,161,44],[156,72,161,45],[157,12,163,6],[157,16,163,10],[157,17,163,11,"snapshot"],[157,25,163,19],[157,26,163,20,"exists"],[157,32,163,26],[157,33,163,27],[157,34,163,28],[157,36,163,30],[158,14,164,8],[158,18,164,14,"metadata"],[158,26,164,36],[158,29,164,39],[159,16,165,10,"bookingId"],[159,25,165,19],[160,16,166,10,"customerId"],[160,26,166,20],[161,16,167,10,"customerName"],[161,28,167,22],[162,16,168,10,"professionalId"],[162,30,168,24],[163,16,169,10,"professionalName"],[163,32,169,26],[164,16,170,10,"lastMessage"],[164,27,170,21],[164,29,170,23],[164,31,170,25],[165,16,171,10,"lastMessageTimestamp"],[165,36,171,30],[165,38,171,32,"Date"],[165,42,171,36],[165,43,171,37,"now"],[165,46,171,40],[165,47,171,41],[165,48,171,42],[166,16,172,10,"unreadCountCustomer"],[166,35,172,29],[166,37,172,31],[166,38,172,32],[167,16,173,10,"unreadCountProfessional"],[167,39,173,33],[167,41,173,35],[168,14,174,8],[168,15,174,9],[169,14,175,8],[169,20,175,14],[169,24,175,14,"set"],[169,41,175,17],[169,42,175,17,"set"],[169,45,175,17],[169,47,175,18,"metadataRef"],[169,58,175,29],[169,60,175,31,"metadata"],[169,68,175,39],[169,69,175,40],[170,12,176,6],[171,10,177,4],[171,11,177,5],[171,12,177,6],[171,19,177,13,"error"],[171,24,177,18],[171,26,177,20],[172,12,178,6,"console"],[172,19,178,13],[172,20,178,14,"error"],[172,25,178,19],[172,26,178,20],[172,61,178,55],[172,63,178,57,"error"],[172,68,178,62],[172,69,178,63],[173,10,179,4],[174,8,180,2],[174,9,180,3],[175,8,180,3],[175,17,152,8,"initializeChatMetadata"],[175,39,152,30,"initializeChatMetadata"],[175,40,152,30,"_x10"],[175,44,152,30],[175,46,152,30,"_x11"],[175,50,152,30],[175,52,152,30,"_x12"],[175,56,152,30],[175,58,152,30,"_x13"],[175,62,152,30],[175,64,152,30,"_x14"],[175,68,152,30],[176,10,152,30],[176,17,152,30,"_initializeChatMetadata"],[176,40,152,30],[176,41,152,30,"apply"],[176,46,152,30],[176,53,152,30,"arguments"],[176,62,152,30],[177,8,152,30],[178,8,152,30],[178,15,152,8,"initializeChatMetadata"],[178,37,152,30],[179,6,152,30],[179,10,182,2],[180,4,182,2],[181,6,182,2,"key"],[181,9,182,2],[182,6,182,2,"value"],[182,11,182,2],[183,8,182,2],[183,12,182,2,"_getUnreadCount"],[183,27,182,2],[183,34,182,2,"_asyncToGenerator"],[183,51,182,2],[183,52,182,2,"default"],[183,59,182,2],[183,61,183,2],[183,72,183,23,"bookingId"],[183,81,183,40],[183,83,183,42,"userType"],[183,91,183,79],[183,93,183,98],[184,10,184,4],[184,14,184,8],[185,12,185,6],[185,16,185,12,"field"],[185,21,185,17],[185,24,185,20,"userType"],[185,32,185,28],[185,37,185,33],[185,47,185,43],[185,50,185,46],[185,71,185,67],[185,74,185,70],[185,99,185,95],[186,12,186,6],[186,16,186,12,"unreadRef"],[186,25,186,21],[186,28,186,24],[186,32,186,24,"ref"],[186,49,186,27],[186,50,186,27,"ref"],[186,53,186,27],[186,55,186,28,"database"],[186,70,186,36],[186,71,186,36,"database"],[186,79,186,36],[186,81,186,38],[186,90,186,47,"bookingId"],[186,99,186,56],[186,112,186,69,"field"],[186,117,186,74],[186,119,186,76],[186,120,186,77],[187,12,187,6],[187,16,187,12,"snapshot"],[187,24,187,20],[187,33,187,29],[187,37,187,29,"get"],[187,54,187,32],[187,55,187,32,"get"],[187,58,187,32],[187,60,187,33,"unreadRef"],[187,69,187,42],[187,70,187,43],[188,12,188,6],[188,19,188,13,"snapshot"],[188,27,188,21],[188,28,188,22,"val"],[188,31,188,25],[188,32,188,26],[188,33,188,27],[188,37,188,31],[188,38,188,32],[189,10,189,4],[189,11,189,5],[189,12,189,6],[189,19,189,13,"error"],[189,24,189,18],[189,26,189,20],[190,12,190,6,"console"],[190,19,190,13],[190,20,190,14,"error"],[190,25,190,19],[190,26,190,20],[190,55,190,49],[190,57,190,51,"error"],[190,62,190,56],[190,63,190,57],[191,12,191,6],[191,19,191,13],[191,20,191,14],[192,10,192,4],[193,8,193,2],[193,9,193,3],[194,8,193,3],[194,17,183,8,"getUnreadCount"],[194,31,183,22,"getUnreadCount"],[194,32,183,22,"_x15"],[194,36,183,22],[194,38,183,22,"_x16"],[194,42,183,22],[195,10,183,22],[195,17,183,22,"_getUnreadCount"],[195,32,183,22],[195,33,183,22,"apply"],[195,38,183,22],[195,45,183,22,"arguments"],[195,54,183,22],[196,8,183,22],[197,8,183,22],[197,15,183,8,"getUnreadCount"],[197,29,183,22],[198,6,183,22],[198,10,195,2],[199,4,195,2],[200,6,195,2,"key"],[200,9,195,2],[201,6,195,2,"value"],[201,11,195,2],[202,8,195,2],[202,12,195,2,"_getUserChats"],[202,25,195,2],[202,32,195,2,"_asyncToGenerator"],[202,49,195,2],[202,50,195,2,"default"],[202,57,195,2],[202,59,196,2],[202,70,196,21,"userId"],[202,76,196,35],[202,78,196,37,"userType"],[202,86,196,74],[202,88,196,101],[203,10,197,4],[203,14,197,8],[204,12,198,6],[204,16,198,12,"chatsRef"],[204,24,198,20],[204,27,198,23],[204,31,198,23,"ref"],[204,48,198,26],[204,49,198,26,"ref"],[204,52,198,26],[204,54,198,27,"database"],[204,69,198,35],[204,70,198,35,"database"],[204,78,198,35],[204,80,198,37],[204,87,198,44],[204,88,198,45],[205,12,199,6],[205,16,199,12,"snapshot"],[205,24,199,20],[205,33,199,29],[205,37,199,29,"get"],[205,54,199,32],[205,55,199,32,"get"],[205,58,199,32],[205,60,199,33,"chatsRef"],[205,68,199,41],[205,69,199,42],[206,12,200,6],[206,16,200,12,"chats"],[206,21,200,33],[206,24,200,36],[206,26,200,38],[207,12,202,6,"snapshot"],[207,20,202,14],[207,21,202,15,"forEach"],[207,28,202,22],[207,29,202,24,"childSnapshot"],[207,42,202,37],[207,46,202,42],[208,14,203,8],[208,18,203,14,"metadata"],[208,26,203,22],[208,29,203,25,"childSnapshot"],[208,42,203,38],[208,43,203,39,"val"],[208,46,203,42],[208,47,203,43],[208,48,203,44],[208,49,203,45,"metadata"],[208,57,203,53],[209,14,204,8],[209,18,204,12,"metadata"],[209,26,204,20],[209,28,204,22],[210,16,205,10],[210,20,205,16,"isUserChat"],[210,30,205,26],[210,33,206,12,"userType"],[210,41,206,20],[210,46,206,25],[210,56,206,35],[210,59,207,16,"metadata"],[210,67,207,24],[210,68,207,25,"customerId"],[210,78,207,35],[210,83,207,40,"userId"],[210,89,207,46],[210,92,208,16,"metadata"],[210,100,208,24],[210,101,208,25,"professionalId"],[210,115,208,39],[210,120,208,44,"userId"],[210,126,208,50],[211,16,210,10],[211,20,210,14,"isUserChat"],[211,30,210,24],[211,32,210,26],[212,18,211,12,"chats"],[212,23,211,17],[212,24,211,18,"push"],[212,28,211,22],[212,29,211,23,"metadata"],[212,37,211,31],[212,38,211,32],[213,16,212,10],[214,14,213,8],[215,12,214,6],[215,13,214,7],[215,14,214,8],[217,12,216,6],[218,12,217,6,"chats"],[218,17,217,11],[218,18,217,12,"sort"],[218,22,217,16],[218,23,217,17],[218,24,217,18,"a"],[218,25,217,19],[218,27,217,21,"b"],[218,28,217,22],[218,33,217,27,"b"],[218,34,217,28],[218,35,217,29,"lastMessageTimestamp"],[218,55,217,49],[218,58,217,52,"a"],[218,59,217,53],[218,60,217,54,"lastMessageTimestamp"],[218,80,217,74],[218,81,217,75],[219,12,218,6],[219,19,218,13,"chats"],[219,24,218,18],[220,10,219,4],[220,11,219,5],[220,12,219,6],[220,19,219,13,"error"],[220,24,219,18],[220,26,219,20],[221,12,220,6,"console"],[221,19,220,13],[221,20,220,14,"error"],[221,25,220,19],[221,26,220,20],[221,53,220,47],[221,55,220,49,"error"],[221,60,220,54],[221,61,220,55],[222,12,221,6],[222,19,221,13],[222,21,221,15],[223,10,222,4],[224,8,223,2],[224,9,223,3],[225,8,223,3],[225,17,196,8,"getUserChats"],[225,29,196,20,"getUserChats"],[225,30,196,20,"_x17"],[225,34,196,20],[225,36,196,20,"_x18"],[225,40,196,20],[226,10,196,20],[226,17,196,20,"_getUserChats"],[226,30,196,20],[226,31,196,20,"apply"],[226,36,196,20],[226,43,196,20,"arguments"],[226,52,196,20],[227,8,196,20],[228,8,196,20],[228,15,196,8,"getUserChats"],[228,27,196,20],[229,6,196,20],[230,4,196,20],[231,2,196,20],[232,2,226,0],[232,6,226,0,"_default"],[232,14,226,0],[232,17,226,15],[232,21,226,19,"ChatService"],[232,32,226,30],[232,33,226,31],[232,34,226,32],[233,0,226,33],[233,3]],"functionMap":{"names":["<global>","ChatService","ChatService#sendMessage","ChatService#listenToMessages","onValue$argument_1","snapshot.forEach$argument_0","<anonymous>","ChatService#markMessagesAsRead","ChatService#updateChatMetadata","ChatService#initializeChatMetadata","ChatService#getUnreadCount","ChatService#getUserChats","chats.sort$argument_0"],"mappings":"AAA;AC0B;ECE;GD2B;EEG;0CCU;uBCE;ODK;KDE;WGG;KHE;GFC;EMG;uBFU;OEM;GNiB;EOG;GP0B;EQG;GR4B;ESG;GTU;EUG;uBNM;OMY;iBCG,yDD;GVM;CDC"},"hasCjsExports":false},"type":"js/module"}]}