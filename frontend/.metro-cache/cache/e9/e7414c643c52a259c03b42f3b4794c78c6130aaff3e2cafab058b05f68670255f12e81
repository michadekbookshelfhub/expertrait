{"dependencies":[{"name":"util","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":9,"column":13,"index":220},"end":{"line":9,"column":28,"index":235}}],"key":"plO20G0zye191TqKMAMeOagk9EI=","exportNames":["*"],"imports":1}},{"name":"websocket-driver","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":10,"column":13,"index":250},"end":{"line":10,"column":40,"index":277}}],"key":"Cj2ni/iUrqCVJoi2pP++qMSV158=","exportNames":["*"],"imports":1}},{"name":"./websocket/api","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":11,"column":13,"index":292},"end":{"line":11,"column":39,"index":318}}],"key":"bWRWJ8weoeWYinETkuPamMRkS7w=","exportNames":["*"],"imports":1}},{"name":"./websocket/client","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":44,"column":24,"index":1200},"end":{"line":44,"column":53,"index":1229}}],"key":"3tJvX031zkuyrHRuXklXhM6tLx4=","exportNames":["*"],"imports":1}},{"name":"./eventsource","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":45,"column":24,"index":1255},"end":{"line":45,"column":48,"index":1279}}],"key":"xQ7OejUIRrxaFJeaaKeJ6W8CXoo=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  // API references:\n  //\n  // * https://html.spec.whatwg.org/multipage/comms.html#network\n  // * https://dom.spec.whatwg.org/#interface-eventtarget\n  // * https://dom.spec.whatwg.org/#interface-event\n\n  'use strict';\n\n  var util = require(_dependencyMap[0], \"util\"),\n    driver = require(_dependencyMap[1], \"websocket-driver\"),\n    API = require(_dependencyMap[2], \"./websocket/api\");\n  var WebSocket = function (request, socket, body, protocols, options) {\n    options = options || {};\n    this._stream = socket;\n    this._driver = driver.http(request, {\n      maxLength: options.maxLength,\n      protocols: protocols\n    });\n    var self = this;\n    if (!this._stream || !this._stream.writable) return;\n    if (!this._stream.readable) return this._stream.end();\n    var catchup = function () {\n      self._stream.removeListener('data', catchup);\n    };\n    this._stream.on('data', catchup);\n    API.call(this, options);\n    process.nextTick(function () {\n      self._driver.start();\n      self._driver.io.write(body);\n    });\n  };\n  util.inherits(WebSocket, API);\n  WebSocket.isWebSocket = function (request) {\n    return driver.isWebSocket(request);\n  };\n  WebSocket.validateOptions = function (options, validKeys) {\n    driver.validateOptions(options, validKeys);\n  };\n  WebSocket.WebSocket = WebSocket;\n  WebSocket.Client = require(_dependencyMap[3], \"./websocket/client\");\n  WebSocket.EventSource = require(_dependencyMap[4], \"./eventsource\");\n  module.exports = WebSocket;\n});","lineCount":44,"map":[[2,2,1,0],[3,2,2,0],[4,2,3,0],[5,2,4,0],[6,2,5,0],[8,2,7,0],[8,14,7,12],[10,2,9,0],[10,6,9,4,"util"],[10,10,9,8],[10,13,9,13,"require"],[10,20,9,20],[10,21,9,20,"_dependencyMap"],[10,35,9,20],[10,46,9,27],[10,47,9,28],[11,4,10,4,"driver"],[11,10,10,10],[11,13,10,13,"require"],[11,20,10,20],[11,21,10,20,"_dependencyMap"],[11,35,10,20],[11,58,10,39],[11,59,10,40],[12,4,11,4,"API"],[12,7,11,7],[12,10,11,13,"require"],[12,17,11,20],[12,18,11,20,"_dependencyMap"],[12,32,11,20],[12,54,11,38],[12,55,11,39],[13,2,13,0],[13,6,13,4,"WebSocket"],[13,15,13,13],[13,18,13,16],[13,27,13,16,"WebSocket"],[13,28,13,25,"request"],[13,35,13,32],[13,37,13,34,"socket"],[13,43,13,40],[13,45,13,42,"body"],[13,49,13,46],[13,51,13,48,"protocols"],[13,60,13,57],[13,62,13,59,"options"],[13,69,13,66],[13,71,13,68],[14,4,14,2,"options"],[14,11,14,9],[14,14,14,12,"options"],[14,21,14,19],[14,25,14,23],[14,26,14,24],[14,27,14,25],[15,4,16,2],[15,8,16,6],[15,9,16,7,"_stream"],[15,16,16,14],[15,19,16,17,"socket"],[15,25,16,23],[16,4,17,2],[16,8,17,6],[16,9,17,7,"_driver"],[16,16,17,14],[16,19,17,17,"driver"],[16,25,17,23],[16,26,17,24,"http"],[16,30,17,28],[16,31,17,29,"request"],[16,38,17,36],[16,40,17,38],[17,6,17,40,"maxLength"],[17,15,17,49],[17,17,17,51,"options"],[17,24,17,58],[17,25,17,59,"maxLength"],[17,34,17,68],[18,6,17,70,"protocols"],[18,15,17,79],[18,17,17,81,"protocols"],[19,4,17,91],[19,5,17,92],[19,6,17,93],[20,4,19,2],[20,8,19,6,"self"],[20,12,19,10],[20,15,19,13],[20,19,19,17],[21,4,20,2],[21,8,20,6],[21,9,20,7],[21,13,20,11],[21,14,20,12,"_stream"],[21,21,20,19],[21,25,20,23],[21,26,20,24],[21,30,20,28],[21,31,20,29,"_stream"],[21,38,20,36],[21,39,20,37,"writable"],[21,47,20,45],[21,49,20,47],[22,4,21,2],[22,8,21,6],[22,9,21,7],[22,13,21,11],[22,14,21,12,"_stream"],[22,21,21,19],[22,22,21,20,"readable"],[22,30,21,28],[22,32,21,30],[22,39,21,37],[22,43,21,41],[22,44,21,42,"_stream"],[22,51,21,49],[22,52,21,50,"end"],[22,55,21,53],[22,56,21,54],[22,57,21,55],[23,4,23,2],[23,8,23,6,"catchup"],[23,15,23,13],[23,18,23,16],[23,27,23,16,"catchup"],[23,28,23,16],[23,30,23,27],[24,6,23,29,"self"],[24,10,23,33],[24,11,23,34,"_stream"],[24,18,23,41],[24,19,23,42,"removeListener"],[24,33,23,56],[24,34,23,57],[24,40,23,63],[24,42,23,65,"catchup"],[24,49,23,72],[24,50,23,73],[25,4,23,74],[25,5,23,75],[26,4,24,2],[26,8,24,6],[26,9,24,7,"_stream"],[26,16,24,14],[26,17,24,15,"on"],[26,19,24,17],[26,20,24,18],[26,26,24,24],[26,28,24,26,"catchup"],[26,35,24,33],[26,36,24,34],[27,4,26,2,"API"],[27,7,26,5],[27,8,26,6,"call"],[27,12,26,10],[27,13,26,11],[27,17,26,15],[27,19,26,17,"options"],[27,26,26,24],[27,27,26,25],[28,4,28,2,"process"],[28,11,28,9],[28,12,28,10,"nextTick"],[28,20,28,18],[28,21,28,19],[28,33,28,30],[29,6,29,4,"self"],[29,10,29,8],[29,11,29,9,"_driver"],[29,18,29,16],[29,19,29,17,"start"],[29,24,29,22],[29,25,29,23],[29,26,29,24],[30,6,30,4,"self"],[30,10,30,8],[30,11,30,9,"_driver"],[30,18,30,16],[30,19,30,17,"io"],[30,21,30,19],[30,22,30,20,"write"],[30,27,30,25],[30,28,30,26,"body"],[30,32,30,30],[30,33,30,31],[31,4,31,2],[31,5,31,3],[31,6,31,4],[32,2,32,0],[32,3,32,1],[33,2,33,0,"util"],[33,6,33,4],[33,7,33,5,"inherits"],[33,15,33,13],[33,16,33,14,"WebSocket"],[33,25,33,23],[33,27,33,25,"API"],[33,30,33,28],[33,31,33,29],[34,2,35,0,"WebSocket"],[34,11,35,9],[34,12,35,10,"isWebSocket"],[34,23,35,21],[34,26,35,24],[34,36,35,33,"request"],[34,43,35,40],[34,45,35,42],[35,4,36,2],[35,11,36,9,"driver"],[35,17,36,15],[35,18,36,16,"isWebSocket"],[35,29,36,27],[35,30,36,28,"request"],[35,37,36,35],[35,38,36,36],[36,2,37,0],[36,3,37,1],[37,2,39,0,"WebSocket"],[37,11,39,9],[37,12,39,10,"validateOptions"],[37,27,39,25],[37,30,39,28],[37,40,39,37,"options"],[37,47,39,44],[37,49,39,46,"validKeys"],[37,58,39,55],[37,60,39,57],[38,4,40,2,"driver"],[38,10,40,8],[38,11,40,9,"validateOptions"],[38,26,40,24],[38,27,40,25,"options"],[38,34,40,32],[38,36,40,34,"validKeys"],[38,45,40,43],[38,46,40,44],[39,2,41,0],[39,3,41,1],[40,2,43,0,"WebSocket"],[40,11,43,9],[40,12,43,10,"WebSocket"],[40,21,43,19],[40,24,43,24,"WebSocket"],[40,33,43,33],[41,2,44,0,"WebSocket"],[41,11,44,9],[41,12,44,10,"Client"],[41,18,44,16],[41,21,44,24,"require"],[41,28,44,31],[41,29,44,31,"_dependencyMap"],[41,43,44,31],[41,68,44,52],[41,69,44,53],[42,2,45,0,"WebSocket"],[42,11,45,9],[42,12,45,10,"EventSource"],[42,23,45,21],[42,26,45,24,"require"],[42,33,45,31],[42,34,45,31,"_dependencyMap"],[42,48,45,31],[42,68,45,47],[42,69,45,48],[43,2,47,0,"module"],[43,8,47,6],[43,9,47,7,"exports"],[43,16,47,14],[43,19,47,24,"WebSocket"],[43,28,47,33],[44,0,47,34],[44,3]],"functionMap":{"names":["<global>","WebSocket","catchup","process.nextTick$argument_0","WebSocket.isWebSocket","WebSocket.validateOptions"],"mappings":"AAA;gBCY;gBCU,2DD;mBEK;GFG;CDC;wBIG;CJE;4BKE;CLE"},"hasCjsExports":true},"type":"js/module"}]}