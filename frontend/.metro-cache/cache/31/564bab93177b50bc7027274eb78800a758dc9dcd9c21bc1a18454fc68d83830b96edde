{"dependencies":[{"name":"../config/firebase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"K/SZPG5sPeV1upVh8dao26aG7MQ=","exportNames":["*"],"imports":1}},{"name":"firebase/database","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":47},"end":{"line":2,"column":104,"index":151}}],"key":"ZF/J3nfk5GUgbzXl84BqV1IxYEE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _configFirebase = require(_dependencyMap[0], \"../config/firebase\");\n  var _firebaseDatabase = require(_dependencyMap[1], \"firebase/database\");\n  class ChatService {\n    // Send a message\n    async sendMessage(bookingId, senderId, senderName, senderType, message) {\n      try {\n        const messagesRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/messages`);\n        const newMessage = {\n          bookingId,\n          senderId,\n          senderName,\n          senderType,\n          message,\n          timestamp: Date.now(),\n          read: false\n        };\n        await (0, _firebaseDatabase.push)(messagesRef, newMessage);\n\n        // Update chat metadata\n        await this.updateChatMetadata(bookingId, message, senderType);\n      } catch (error) {\n        console.error('Error sending message:', error);\n        throw error;\n      }\n    }\n\n    // Listen to messages in real-time\n    listenToMessages(bookingId, callback) {\n      const messagesRef = (0, _firebaseDatabase.query)((0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/messages`), (0, _firebaseDatabase.orderByChild)('timestamp'), (0, _firebaseDatabase.limitToLast)(100));\n      const listener = (0, _firebaseDatabase.onValue)(messagesRef, snapshot => {\n        const messages = [];\n        snapshot.forEach(childSnapshot => {\n          messages.push({\n            id: childSnapshot.key || undefined,\n            ...childSnapshot.val()\n          });\n        });\n        callback(messages);\n      });\n\n      // Return cleanup function\n      return () => {\n        (0, _firebaseDatabase.off)(messagesRef);\n      };\n    }\n\n    // Mark messages as read\n    async markMessagesAsRead(bookingId, userId, userType) {\n      try {\n        const messagesRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/messages`);\n        const snapshot = await (0, _firebaseDatabase.get)(messagesRef);\n        const updates = {};\n        snapshot.forEach(childSnapshot => {\n          const message = childSnapshot.val();\n          // Mark as read if the message is from the other party\n          if (message.senderId !== userId && !message.read) {\n            updates[`${childSnapshot.key}/read`] = true;\n          }\n        });\n        if (Object.keys(updates).length > 0) {\n          const messagesRefWithUpdates = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/messages`);\n          await (0, _firebaseDatabase.set)(messagesRefWithUpdates, updates);\n        }\n\n        // Reset unread count\n        const metadataRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata`);\n        if (userType === 'customer') {\n          await (0, _firebaseDatabase.set)((0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata/unreadCountCustomer`), 0);\n        } else {\n          await (0, _firebaseDatabase.set)((0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata/unreadCountProfessional`), 0);\n        }\n      } catch (error) {\n        console.error('Error marking messages as read:', error);\n      }\n    }\n\n    // Update chat metadata\n    async updateChatMetadata(bookingId, lastMessage, senderType) {\n      try {\n        const metadataRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata`);\n        const snapshot = await (0, _firebaseDatabase.get)(metadataRef);\n        const currentMetadata = snapshot.val() || {};\n        const updates = {\n          lastMessage: lastMessage.substring(0, 100),\n          lastMessageTimestamp: Date.now()\n        };\n\n        // Increment unread count for the receiver\n        if (senderType === 'customer') {\n          updates['unreadCountProfessional'] = (currentMetadata.unreadCountProfessional || 0) + 1;\n        } else {\n          updates['unreadCountCustomer'] = (currentMetadata.unreadCountCustomer || 0) + 1;\n        }\n        await (0, _firebaseDatabase.set)(metadataRef, {\n          ...currentMetadata,\n          ...updates\n        });\n      } catch (error) {\n        console.error('Error updating chat metadata:', error);\n      }\n    }\n\n    // Initialize chat metadata\n    async initializeChatMetadata(bookingId, customerId, customerName, professionalId, professionalName) {\n      try {\n        const metadataRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata`);\n        const snapshot = await (0, _firebaseDatabase.get)(metadataRef);\n        if (!snapshot.exists()) {\n          const metadata = {\n            bookingId,\n            customerId,\n            customerName,\n            professionalId,\n            professionalName,\n            lastMessage: '',\n            lastMessageTimestamp: Date.now(),\n            unreadCountCustomer: 0,\n            unreadCountProfessional: 0\n          };\n          await (0, _firebaseDatabase.set)(metadataRef, metadata);\n        }\n      } catch (error) {\n        console.error('Error initializing chat metadata:', error);\n      }\n    }\n\n    // Get unread count\n    async getUnreadCount(bookingId, userType) {\n      try {\n        const field = userType === 'customer' ? 'unreadCountCustomer' : 'unreadCountProfessional';\n        const unreadRef = (0, _firebaseDatabase.ref)(_configFirebase.database, `chats/${bookingId}/metadata/${field}`);\n        const snapshot = await (0, _firebaseDatabase.get)(unreadRef);\n        return snapshot.val() || 0;\n      } catch (error) {\n        console.error('Error getting unread count:', error);\n        return 0;\n      }\n    }\n\n    // Get all chats for a user\n    async getUserChats(userId, userType) {\n      try {\n        const chatsRef = (0, _firebaseDatabase.ref)(_configFirebase.database, 'chats');\n        const snapshot = await (0, _firebaseDatabase.get)(chatsRef);\n        const chats = [];\n        snapshot.forEach(childSnapshot => {\n          const metadata = childSnapshot.val().metadata;\n          if (metadata) {\n            const isUserChat = userType === 'customer' ? metadata.customerId === userId : metadata.professionalId === userId;\n            if (isUserChat) {\n              chats.push(metadata);\n            }\n          }\n        });\n\n        // Sort by last message timestamp\n        chats.sort((a, b) => b.lastMessageTimestamp - a.lastMessageTimestamp);\n        return chats;\n      } catch (error) {\n        console.error('Error getting user chats:', error);\n        return [];\n      }\n    }\n  }\n  var _default = new ChatService();\n});","lineCount":178,"map":[[7,2,226,0,"Object"],[7,8,226,0],[7,9,226,0,"defineProperty"],[7,23,226,0],[7,24,226,0,"exports"],[7,31,226,0],[8,4,226,0,"enumerable"],[8,14,226,0],[9,4,226,0,"get"],[9,7,226,0],[9,18,226,0,"get"],[9,19,226,0],[10,6,226,0],[10,13,226,0,"_default"],[10,21,226,0],[11,4,226,0],[12,2,226,0],[13,2,1,0],[13,6,1,0,"_configFirebase"],[13,21,1,0],[13,24,1,0,"require"],[13,31,1,0],[13,32,1,0,"_dependencyMap"],[13,46,1,0],[14,2,2,0],[14,6,2,0,"_firebaseDatabase"],[14,23,2,0],[14,26,2,0,"require"],[14,33,2,0],[14,34,2,0,"_dependencyMap"],[14,48,2,0],[15,2,27,0],[15,8,27,6,"ChatService"],[15,19,27,17],[15,20,27,18],[16,4,28,2],[17,4,29,2],[17,10,29,8,"sendMessage"],[17,21,29,19,"sendMessage"],[17,22,30,4,"bookingId"],[17,31,30,21],[17,33,31,4,"senderId"],[17,41,31,20],[17,43,32,4,"senderName"],[17,53,32,22],[17,55,33,4,"senderType"],[17,65,33,43],[17,67,34,4,"message"],[17,74,34,19],[17,76,35,19],[18,6,36,4],[18,10,36,8],[19,8,37,6],[19,14,37,12,"messagesRef"],[19,25,37,23],[19,28,37,26],[19,32,37,26,"ref"],[19,49,37,29],[19,50,37,29,"ref"],[19,53,37,29],[19,55,37,30,"database"],[19,70,37,38],[19,71,37,38,"database"],[19,79,37,38],[19,81,37,40],[19,90,37,49,"bookingId"],[19,99,37,58],[19,110,37,69],[19,111,37,70],[20,8,38,6],[20,14,38,12,"newMessage"],[20,24,38,47],[20,27,38,50],[21,10,39,8,"bookingId"],[21,19,39,17],[22,10,40,8,"senderId"],[22,18,40,16],[23,10,41,8,"senderName"],[23,20,41,18],[24,10,42,8,"senderType"],[24,20,42,18],[25,10,43,8,"message"],[25,17,43,15],[26,10,44,8,"timestamp"],[26,19,44,17],[26,21,44,19,"Date"],[26,25,44,23],[26,26,44,24,"now"],[26,29,44,27],[26,30,44,28],[26,31,44,29],[27,10,45,8,"read"],[27,14,45,12],[27,16,45,14],[28,8,46,6],[28,9,46,7],[29,8,48,6],[29,14,48,12],[29,18,48,12,"push"],[29,35,48,16],[29,36,48,16,"push"],[29,40,48,16],[29,42,48,17,"messagesRef"],[29,53,48,28],[29,55,48,30,"newMessage"],[29,65,48,40],[29,66,48,41],[31,8,50,6],[32,8,51,6],[32,14,51,12],[32,18,51,16],[32,19,51,17,"updateChatMetadata"],[32,37,51,35],[32,38,51,36,"bookingId"],[32,47,51,45],[32,49,51,47,"message"],[32,56,51,54],[32,58,51,56,"senderType"],[32,68,51,66],[32,69,51,67],[33,6,52,4],[33,7,52,5],[33,8,52,6],[33,15,52,13,"error"],[33,20,52,18],[33,22,52,20],[34,8,53,6,"console"],[34,15,53,13],[34,16,53,14,"error"],[34,21,53,19],[34,22,53,20],[34,46,53,44],[34,48,53,46,"error"],[34,53,53,51],[34,54,53,52],[35,8,54,6],[35,14,54,12,"error"],[35,19,54,17],[36,6,55,4],[37,4,56,2],[39,4,58,2],[40,4,59,2,"listenToMessages"],[40,20,59,18,"listenToMessages"],[40,21,60,4,"bookingId"],[40,30,60,21],[40,32,61,4,"callback"],[40,40,61,47],[40,42,62,16],[41,6,63,4],[41,12,63,10,"messagesRef"],[41,23,63,21],[41,26,63,24],[41,30,63,24,"query"],[41,47,63,29],[41,48,63,29,"query"],[41,53,63,29],[41,55,64,6],[41,59,64,6,"ref"],[41,76,64,9],[41,77,64,9,"ref"],[41,80,64,9],[41,82,64,10,"database"],[41,97,64,18],[41,98,64,18,"database"],[41,106,64,18],[41,108,64,20],[41,117,64,29,"bookingId"],[41,126,64,38],[41,137,64,49],[41,138,64,50],[41,140,65,6],[41,144,65,6,"orderByChild"],[41,161,65,18],[41,162,65,18,"orderByChild"],[41,174,65,18],[41,176,65,19],[41,187,65,30],[41,188,65,31],[41,190,66,6],[41,194,66,6,"limitToLast"],[41,211,66,17],[41,212,66,17,"limitToLast"],[41,223,66,17],[41,225,66,18],[41,228,66,21],[41,229,67,4],[41,230,67,5],[42,6,69,4],[42,12,69,10,"listener"],[42,20,69,18],[42,23,69,21],[42,27,69,21,"onValue"],[42,44,69,28],[42,45,69,28,"onValue"],[42,52,69,28],[42,54,69,29,"messagesRef"],[42,65,69,40],[42,67,69,43,"snapshot"],[42,75,69,51],[42,79,69,56],[43,8,70,6],[43,14,70,12,"messages"],[43,22,70,35],[43,25,70,38],[43,27,70,40],[44,8,71,6,"snapshot"],[44,16,71,14],[44,17,71,15,"forEach"],[44,24,71,22],[44,25,71,24,"childSnapshot"],[44,38,71,37],[44,42,71,42],[45,10,72,8,"messages"],[45,18,72,16],[45,19,72,17,"push"],[45,23,72,21],[45,24,72,22],[46,12,73,10,"id"],[46,14,73,12],[46,16,73,14,"childSnapshot"],[46,29,73,27],[46,30,73,28,"key"],[46,33,73,31],[46,37,73,35,"undefined"],[46,46,73,44],[47,12,74,10],[47,15,74,13,"childSnapshot"],[47,28,74,26],[47,29,74,27,"val"],[47,32,74,30],[47,33,74,31],[48,10,75,8],[48,11,75,9],[48,12,75,10],[49,8,76,6],[49,9,76,7],[49,10,76,8],[50,8,77,6,"callback"],[50,16,77,14],[50,17,77,15,"messages"],[50,25,77,23],[50,26,77,24],[51,6,78,4],[51,7,78,5],[51,8,78,6],[53,6,80,4],[54,6,81,4],[54,13,81,11],[54,19,81,17],[55,8,82,6],[55,12,82,6,"off"],[55,29,82,9],[55,30,82,9,"off"],[55,33,82,9],[55,35,82,10,"messagesRef"],[55,46,82,21],[55,47,82,22],[56,6,83,4],[56,7,83,5],[57,4,84,2],[59,4,86,2],[60,4,87,2],[60,10,87,8,"markMessagesAsRead"],[60,28,87,26,"markMessagesAsRead"],[60,29,88,4,"bookingId"],[60,38,88,21],[60,40,89,4,"userId"],[60,46,89,18],[60,48,90,4,"userType"],[60,56,90,41],[60,58,91,19],[61,6,92,4],[61,10,92,8],[62,8,93,6],[62,14,93,12,"messagesRef"],[62,25,93,23],[62,28,93,26],[62,32,93,26,"ref"],[62,49,93,29],[62,50,93,29,"ref"],[62,53,93,29],[62,55,93,30,"database"],[62,70,93,38],[62,71,93,38,"database"],[62,79,93,38],[62,81,93,40],[62,90,93,49,"bookingId"],[62,99,93,58],[62,110,93,69],[62,111,93,70],[63,8,94,6],[63,14,94,12,"snapshot"],[63,22,94,20],[63,25,94,23],[63,31,94,29],[63,35,94,29,"get"],[63,52,94,32],[63,53,94,32,"get"],[63,56,94,32],[63,58,94,33,"messagesRef"],[63,69,94,44],[63,70,94,45],[64,8,96,6],[64,14,96,12,"updates"],[64,21,96,43],[64,24,96,46],[64,25,96,47],[64,26,96,48],[65,8,97,6,"snapshot"],[65,16,97,14],[65,17,97,15,"forEach"],[65,24,97,22],[65,25,97,24,"childSnapshot"],[65,38,97,37],[65,42,97,42],[66,10,98,8],[66,16,98,14,"message"],[66,23,98,21],[66,26,98,24,"childSnapshot"],[66,39,98,37],[66,40,98,38,"val"],[66,43,98,41],[66,44,98,42],[66,45,98,43],[67,10,99,8],[68,10,100,8],[68,14,100,12,"message"],[68,21,100,19],[68,22,100,20,"senderId"],[68,30,100,28],[68,35,100,33,"userId"],[68,41,100,39],[68,45,100,43],[68,46,100,44,"message"],[68,53,100,51],[68,54,100,52,"read"],[68,58,100,56],[68,60,100,58],[69,12,101,10,"updates"],[69,19,101,17],[69,20,101,18],[69,23,101,21,"childSnapshot"],[69,36,101,34],[69,37,101,35,"key"],[69,40,101,38],[69,47,101,45],[69,48,101,46],[69,51,101,49],[69,55,101,53],[70,10,102,8],[71,8,103,6],[71,9,103,7],[71,10,103,8],[72,8,105,6],[72,12,105,10,"Object"],[72,18,105,16],[72,19,105,17,"keys"],[72,23,105,21],[72,24,105,22,"updates"],[72,31,105,29],[72,32,105,30],[72,33,105,31,"length"],[72,39,105,37],[72,42,105,40],[72,43,105,41],[72,45,105,43],[73,10,106,8],[73,16,106,14,"messagesRefWithUpdates"],[73,38,106,36],[73,41,106,39],[73,45,106,39,"ref"],[73,62,106,42],[73,63,106,42,"ref"],[73,66,106,42],[73,68,106,43,"database"],[73,83,106,51],[73,84,106,51,"database"],[73,92,106,51],[73,94,106,53],[73,103,106,62,"bookingId"],[73,112,106,71],[73,123,106,82],[73,124,106,83],[74,10,107,8],[74,16,107,14],[74,20,107,14,"set"],[74,37,107,17],[74,38,107,17,"set"],[74,41,107,17],[74,43,107,18,"messagesRefWithUpdates"],[74,65,107,40],[74,67,107,42,"updates"],[74,74,107,49],[74,75,107,50],[75,8,108,6],[77,8,110,6],[78,8,111,6],[78,14,111,12,"metadataRef"],[78,25,111,23],[78,28,111,26],[78,32,111,26,"ref"],[78,49,111,29],[78,50,111,29,"ref"],[78,53,111,29],[78,55,111,30,"database"],[78,70,111,38],[78,71,111,38,"database"],[78,79,111,38],[78,81,111,40],[78,90,111,49,"bookingId"],[78,99,111,58],[78,110,111,69],[78,111,111,70],[79,8,112,6],[79,12,112,10,"userType"],[79,20,112,18],[79,25,112,23],[79,35,112,33],[79,37,112,35],[80,10,113,8],[80,16,113,14],[80,20,113,14,"set"],[80,37,113,17],[80,38,113,17,"set"],[80,41,113,17],[80,43,113,18],[80,47,113,18,"ref"],[80,64,113,21],[80,65,113,21,"ref"],[80,68,113,21],[80,70,113,22,"database"],[80,85,113,30],[80,86,113,30,"database"],[80,94,113,30],[80,96,113,32],[80,105,113,41,"bookingId"],[80,114,113,50],[80,145,113,81],[80,146,113,82],[80,148,113,84],[80,149,113,85],[80,150,113,86],[81,8,114,6],[81,9,114,7],[81,15,114,13],[82,10,115,8],[82,16,115,14],[82,20,115,14,"set"],[82,37,115,17],[82,38,115,17,"set"],[82,41,115,17],[82,43,115,18],[82,47,115,18,"ref"],[82,64,115,21],[82,65,115,21,"ref"],[82,68,115,21],[82,70,115,22,"database"],[82,85,115,30],[82,86,115,30,"database"],[82,94,115,30],[82,96,115,32],[82,105,115,41,"bookingId"],[82,114,115,50],[82,149,115,85],[82,150,115,86],[82,152,115,88],[82,153,115,89],[82,154,115,90],[83,8,116,6],[84,6,117,4],[84,7,117,5],[84,8,117,6],[84,15,117,13,"error"],[84,20,117,18],[84,22,117,20],[85,8,118,6,"console"],[85,15,118,13],[85,16,118,14,"error"],[85,21,118,19],[85,22,118,20],[85,55,118,53],[85,57,118,55,"error"],[85,62,118,60],[85,63,118,61],[86,6,119,4],[87,4,120,2],[89,4,122,2],[90,4,123,2],[90,10,123,16,"updateChatMetadata"],[90,28,123,34,"updateChatMetadata"],[90,29,124,4,"bookingId"],[90,38,124,21],[90,40,125,4,"lastMessage"],[90,51,125,23],[90,53,126,4,"senderType"],[90,63,126,43],[90,65,127,19],[91,6,128,4],[91,10,128,8],[92,8,129,6],[92,14,129,12,"metadataRef"],[92,25,129,23],[92,28,129,26],[92,32,129,26,"ref"],[92,49,129,29],[92,50,129,29,"ref"],[92,53,129,29],[92,55,129,30,"database"],[92,70,129,38],[92,71,129,38,"database"],[92,79,129,38],[92,81,129,40],[92,90,129,49,"bookingId"],[92,99,129,58],[92,110,129,69],[92,111,129,70],[93,8,130,6],[93,14,130,12,"snapshot"],[93,22,130,20],[93,25,130,23],[93,31,130,29],[93,35,130,29,"get"],[93,52,130,32],[93,53,130,32,"get"],[93,56,130,32],[93,58,130,33,"metadataRef"],[93,69,130,44],[93,70,130,45],[94,8,131,6],[94,14,131,12,"currentMetadata"],[94,29,131,27],[94,32,131,30,"snapshot"],[94,40,131,38],[94,41,131,39,"val"],[94,44,131,42],[94,45,131,43],[94,46,131,44],[94,50,131,48],[94,51,131,49],[94,52,131,50],[95,8,133,6],[95,14,133,12,"updates"],[95,21,133,19],[95,24,133,22],[96,10,134,8,"lastMessage"],[96,21,134,19],[96,23,134,21,"lastMessage"],[96,34,134,32],[96,35,134,33,"substring"],[96,44,134,42],[96,45,134,43],[96,46,134,44],[96,48,134,46],[96,51,134,49],[96,52,134,50],[97,10,135,8,"lastMessageTimestamp"],[97,30,135,28],[97,32,135,30,"Date"],[97,36,135,34],[97,37,135,35,"now"],[97,40,135,38],[97,41,135,39],[98,8,136,6],[98,9,136,7],[100,8,138,6],[101,8,139,6],[101,12,139,10,"senderType"],[101,22,139,20],[101,27,139,25],[101,37,139,35],[101,39,139,37],[102,10,140,8,"updates"],[102,17,140,15],[102,18,140,16],[102,43,140,41],[102,44,140,42],[102,47,140,45],[102,48,140,46,"currentMetadata"],[102,63,140,61],[102,64,140,62,"unreadCountProfessional"],[102,87,140,85],[102,91,140,89],[102,92,140,90],[102,96,140,94],[102,97,140,95],[103,8,141,6],[103,9,141,7],[103,15,141,13],[104,10,142,8,"updates"],[104,17,142,15],[104,18,142,16],[104,39,142,37],[104,40,142,38],[104,43,142,41],[104,44,142,42,"currentMetadata"],[104,59,142,57],[104,60,142,58,"unreadCountCustomer"],[104,79,142,77],[104,83,142,81],[104,84,142,82],[104,88,142,86],[104,89,142,87],[105,8,143,6],[106,8,145,6],[106,14,145,12],[106,18,145,12,"set"],[106,35,145,15],[106,36,145,15,"set"],[106,39,145,15],[106,41,145,16,"metadataRef"],[106,52,145,27],[106,54,145,29],[107,10,145,31],[107,13,145,34,"currentMetadata"],[107,28,145,49],[108,10,145,51],[108,13,145,54,"updates"],[109,8,145,62],[109,9,145,63],[109,10,145,64],[110,6,146,4],[110,7,146,5],[110,8,146,6],[110,15,146,13,"error"],[110,20,146,18],[110,22,146,20],[111,8,147,6,"console"],[111,15,147,13],[111,16,147,14,"error"],[111,21,147,19],[111,22,147,20],[111,53,147,51],[111,55,147,53,"error"],[111,60,147,58],[111,61,147,59],[112,6,148,4],[113,4,149,2],[115,4,151,2],[116,4,152,2],[116,10,152,8,"initializeChatMetadata"],[116,32,152,30,"initializeChatMetadata"],[116,33,153,4,"bookingId"],[116,42,153,21],[116,44,154,4,"customerId"],[116,54,154,22],[116,56,155,4,"customerName"],[116,68,155,24],[116,70,156,4,"professionalId"],[116,84,156,26],[116,86,157,4,"professionalName"],[116,102,157,28],[116,104,158,19],[117,6,159,4],[117,10,159,8],[118,8,160,6],[118,14,160,12,"metadataRef"],[118,25,160,23],[118,28,160,26],[118,32,160,26,"ref"],[118,49,160,29],[118,50,160,29,"ref"],[118,53,160,29],[118,55,160,30,"database"],[118,70,160,38],[118,71,160,38,"database"],[118,79,160,38],[118,81,160,40],[118,90,160,49,"bookingId"],[118,99,160,58],[118,110,160,69],[118,111,160,70],[119,8,161,6],[119,14,161,12,"snapshot"],[119,22,161,20],[119,25,161,23],[119,31,161,29],[119,35,161,29,"get"],[119,52,161,32],[119,53,161,32,"get"],[119,56,161,32],[119,58,161,33,"metadataRef"],[119,69,161,44],[119,70,161,45],[120,8,163,6],[120,12,163,10],[120,13,163,11,"snapshot"],[120,21,163,19],[120,22,163,20,"exists"],[120,28,163,26],[120,29,163,27],[120,30,163,28],[120,32,163,30],[121,10,164,8],[121,16,164,14,"metadata"],[121,24,164,36],[121,27,164,39],[122,12,165,10,"bookingId"],[122,21,165,19],[123,12,166,10,"customerId"],[123,22,166,20],[124,12,167,10,"customerName"],[124,24,167,22],[125,12,168,10,"professionalId"],[125,26,168,24],[126,12,169,10,"professionalName"],[126,28,169,26],[127,12,170,10,"lastMessage"],[127,23,170,21],[127,25,170,23],[127,27,170,25],[128,12,171,10,"lastMessageTimestamp"],[128,32,171,30],[128,34,171,32,"Date"],[128,38,171,36],[128,39,171,37,"now"],[128,42,171,40],[128,43,171,41],[128,44,171,42],[129,12,172,10,"unreadCountCustomer"],[129,31,172,29],[129,33,172,31],[129,34,172,32],[130,12,173,10,"unreadCountProfessional"],[130,35,173,33],[130,37,173,35],[131,10,174,8],[131,11,174,9],[132,10,175,8],[132,16,175,14],[132,20,175,14,"set"],[132,37,175,17],[132,38,175,17,"set"],[132,41,175,17],[132,43,175,18,"metadataRef"],[132,54,175,29],[132,56,175,31,"metadata"],[132,64,175,39],[132,65,175,40],[133,8,176,6],[134,6,177,4],[134,7,177,5],[134,8,177,6],[134,15,177,13,"error"],[134,20,177,18],[134,22,177,20],[135,8,178,6,"console"],[135,15,178,13],[135,16,178,14,"error"],[135,21,178,19],[135,22,178,20],[135,57,178,55],[135,59,178,57,"error"],[135,64,178,62],[135,65,178,63],[136,6,179,4],[137,4,180,2],[139,4,182,2],[140,4,183,2],[140,10,183,8,"getUnreadCount"],[140,24,183,22,"getUnreadCount"],[140,25,183,23,"bookingId"],[140,34,183,40],[140,36,183,42,"userType"],[140,44,183,79],[140,46,183,98],[141,6,184,4],[141,10,184,8],[142,8,185,6],[142,14,185,12,"field"],[142,19,185,17],[142,22,185,20,"userType"],[142,30,185,28],[142,35,185,33],[142,45,185,43],[142,48,185,46],[142,69,185,67],[142,72,185,70],[142,97,185,95],[143,8,186,6],[143,14,186,12,"unreadRef"],[143,23,186,21],[143,26,186,24],[143,30,186,24,"ref"],[143,47,186,27],[143,48,186,27,"ref"],[143,51,186,27],[143,53,186,28,"database"],[143,68,186,36],[143,69,186,36,"database"],[143,77,186,36],[143,79,186,38],[143,88,186,47,"bookingId"],[143,97,186,56],[143,110,186,69,"field"],[143,115,186,74],[143,117,186,76],[143,118,186,77],[144,8,187,6],[144,14,187,12,"snapshot"],[144,22,187,20],[144,25,187,23],[144,31,187,29],[144,35,187,29,"get"],[144,52,187,32],[144,53,187,32,"get"],[144,56,187,32],[144,58,187,33,"unreadRef"],[144,67,187,42],[144,68,187,43],[145,8,188,6],[145,15,188,13,"snapshot"],[145,23,188,21],[145,24,188,22,"val"],[145,27,188,25],[145,28,188,26],[145,29,188,27],[145,33,188,31],[145,34,188,32],[146,6,189,4],[146,7,189,5],[146,8,189,6],[146,15,189,13,"error"],[146,20,189,18],[146,22,189,20],[147,8,190,6,"console"],[147,15,190,13],[147,16,190,14,"error"],[147,21,190,19],[147,22,190,20],[147,51,190,49],[147,53,190,51,"error"],[147,58,190,56],[147,59,190,57],[148,8,191,6],[148,15,191,13],[148,16,191,14],[149,6,192,4],[150,4,193,2],[152,4,195,2],[153,4,196,2],[153,10,196,8,"getUserChats"],[153,22,196,20,"getUserChats"],[153,23,196,21,"userId"],[153,29,196,35],[153,31,196,37,"userType"],[153,39,196,74],[153,41,196,101],[154,6,197,4],[154,10,197,8],[155,8,198,6],[155,14,198,12,"chatsRef"],[155,22,198,20],[155,25,198,23],[155,29,198,23,"ref"],[155,46,198,26],[155,47,198,26,"ref"],[155,50,198,26],[155,52,198,27,"database"],[155,67,198,35],[155,68,198,35,"database"],[155,76,198,35],[155,78,198,37],[155,85,198,44],[155,86,198,45],[156,8,199,6],[156,14,199,12,"snapshot"],[156,22,199,20],[156,25,199,23],[156,31,199,29],[156,35,199,29,"get"],[156,52,199,32],[156,53,199,32,"get"],[156,56,199,32],[156,58,199,33,"chatsRef"],[156,66,199,41],[156,67,199,42],[157,8,200,6],[157,14,200,12,"chats"],[157,19,200,33],[157,22,200,36],[157,24,200,38],[158,8,202,6,"snapshot"],[158,16,202,14],[158,17,202,15,"forEach"],[158,24,202,22],[158,25,202,24,"childSnapshot"],[158,38,202,37],[158,42,202,42],[159,10,203,8],[159,16,203,14,"metadata"],[159,24,203,22],[159,27,203,25,"childSnapshot"],[159,40,203,38],[159,41,203,39,"val"],[159,44,203,42],[159,45,203,43],[159,46,203,44],[159,47,203,45,"metadata"],[159,55,203,53],[160,10,204,8],[160,14,204,12,"metadata"],[160,22,204,20],[160,24,204,22],[161,12,205,10],[161,18,205,16,"isUserChat"],[161,28,205,26],[161,31,206,12,"userType"],[161,39,206,20],[161,44,206,25],[161,54,206,35],[161,57,207,16,"metadata"],[161,65,207,24],[161,66,207,25,"customerId"],[161,76,207,35],[161,81,207,40,"userId"],[161,87,207,46],[161,90,208,16,"metadata"],[161,98,208,24],[161,99,208,25,"professionalId"],[161,113,208,39],[161,118,208,44,"userId"],[161,124,208,50],[162,12,210,10],[162,16,210,14,"isUserChat"],[162,26,210,24],[162,28,210,26],[163,14,211,12,"chats"],[163,19,211,17],[163,20,211,18,"push"],[163,24,211,22],[163,25,211,23,"metadata"],[163,33,211,31],[163,34,211,32],[164,12,212,10],[165,10,213,8],[166,8,214,6],[166,9,214,7],[166,10,214,8],[168,8,216,6],[169,8,217,6,"chats"],[169,13,217,11],[169,14,217,12,"sort"],[169,18,217,16],[169,19,217,17],[169,20,217,18,"a"],[169,21,217,19],[169,23,217,21,"b"],[169,24,217,22],[169,29,217,27,"b"],[169,30,217,28],[169,31,217,29,"lastMessageTimestamp"],[169,51,217,49],[169,54,217,52,"a"],[169,55,217,53],[169,56,217,54,"lastMessageTimestamp"],[169,76,217,74],[169,77,217,75],[170,8,218,6],[170,15,218,13,"chats"],[170,20,218,18],[171,6,219,4],[171,7,219,5],[171,8,219,6],[171,15,219,13,"error"],[171,20,219,18],[171,22,219,20],[172,8,220,6,"console"],[172,15,220,13],[172,16,220,14,"error"],[172,21,220,19],[172,22,220,20],[172,49,220,47],[172,51,220,49,"error"],[172,56,220,54],[172,57,220,55],[173,8,221,6],[173,15,221,13],[173,17,221,15],[174,6,222,4],[175,4,223,2],[176,2,224,0],[177,2,226,0],[177,6,226,0,"_default"],[177,14,226,0],[177,17,226,15],[177,21,226,19,"ChatService"],[177,32,226,30],[177,33,226,31],[177,34,226,32],[178,0,226,33],[178,3]],"functionMap":{"names":["<global>","ChatService","ChatService#sendMessage","ChatService#listenToMessages","onValue$argument_1","snapshot.forEach$argument_0","<anonymous>","ChatService#markMessagesAsRead","ChatService#updateChatMetadata","ChatService#initializeChatMetadata","ChatService#getUnreadCount","ChatService#getUserChats","chats.sort$argument_0"],"mappings":"AAA;AC0B;ECE;GD2B;EEG;0CCU;uBCE;ODK;KDE;WGG;KHE;GFC;EMG;uBFU;OEM;GNiB;EOG;GP0B;EQG;GR4B;ESG;GTU;EUG;uBNM;OMY;iBCG,yDD;GVM;CDC"},"hasCjsExports":false},"type":"js/module"}]}