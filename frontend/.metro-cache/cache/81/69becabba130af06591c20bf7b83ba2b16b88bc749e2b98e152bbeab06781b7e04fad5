{"dependencies":[{"name":"safe-buffer","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":3,"column":17,"index":32},"end":{"line":3,"column":39,"index":54}}],"key":"JYiVyKV2adrbhzv3Ouecl8p4NAI=","exportNames":["*"],"imports":1}},{"name":"stream","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":17,"index":80},"end":{"line":4,"column":34,"index":97}}],"key":"ywjhWBPQUrHXIfwGsbgNg7Szt/A=","exportNames":["*"],"imports":1}},{"name":"url","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":5,"column":17,"index":123},"end":{"line":5,"column":31,"index":137}}],"key":"Ug/DVHoj+F8BpIFoKWnZvPrb/TI=","exportNames":["*"],"imports":1}},{"name":"util","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":17,"index":156},"end":{"line":6,"column":32,"index":171}}],"key":"plO20G0zye191TqKMAMeOagk9EI=","exportNames":["*"],"imports":1}},{"name":"./base","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":17,"index":190},"end":{"line":7,"column":34,"index":207}}],"key":"cAa/j2PXTeXj4b1JbTLYHmmEU2Q=","exportNames":["*"],"imports":1}},{"name":"./headers","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":8,"column":17,"index":226},"end":{"line":8,"column":37,"index":246}}],"key":"SdGU1FC4qA8Bbw1qN5wwnqOr8gw=","exportNames":["*"],"imports":1}},{"name":"../http_parser","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":9,"column":17,"index":265},"end":{"line":9,"column":42,"index":290}}],"key":"6zJqpQBd9350aJ15nnxzU0wd13o=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  var Buffer = require(_dependencyMap[0], \"safe-buffer\").Buffer,\n    Stream = require(_dependencyMap[1], \"stream\").Stream,\n    url = require(_dependencyMap[2], \"url\"),\n    util = require(_dependencyMap[3], \"util\"),\n    Base = require(_dependencyMap[4], \"./base\"),\n    Headers = require(_dependencyMap[5], \"./headers\"),\n    HttpParser = require(_dependencyMap[6], \"../http_parser\");\n  var PORTS = {\n    'ws:': 80,\n    'wss:': 443\n  };\n  var Proxy = function (client, origin, options) {\n    this._client = client;\n    this._http = new HttpParser('response');\n    this._origin = typeof client.url === 'object' ? client.url : url.parse(client.url);\n    this._url = typeof origin === 'object' ? origin : url.parse(origin);\n    this._options = options || {};\n    this._state = 0;\n    this.readable = this.writable = true;\n    this._paused = false;\n    this._headers = new Headers();\n    this._headers.set('Host', this._origin.host);\n    this._headers.set('Connection', 'keep-alive');\n    this._headers.set('Proxy-Connection', 'keep-alive');\n    var auth = this._url.auth && Buffer.from(this._url.auth, 'utf8').toString('base64');\n    if (auth) this._headers.set('Proxy-Authorization', 'Basic ' + auth);\n  };\n  util.inherits(Proxy, Stream);\n  var instance = {\n    setHeader: function (name, value) {\n      if (this._state !== 0) return false;\n      this._headers.set(name, value);\n      return true;\n    },\n    start: function () {\n      if (this._state !== 0) return false;\n      this._state = 1;\n      var origin = this._origin,\n        port = origin.port || PORTS[origin.protocol],\n        start = 'CONNECT ' + origin.hostname + ':' + port + ' HTTP/1.1';\n      var headers = [start, this._headers.toString(), ''];\n      this.emit('data', Buffer.from(headers.join('\\r\\n'), 'utf8'));\n      return true;\n    },\n    pause: function () {\n      this._paused = true;\n    },\n    resume: function () {\n      this._paused = false;\n      this.emit('drain');\n    },\n    write: function (chunk) {\n      if (!this.writable) return false;\n      this._http.parse(chunk);\n      if (!this._http.isComplete()) return !this._paused;\n      this.statusCode = this._http.statusCode;\n      this.headers = this._http.headers;\n      if (this.statusCode === 200) {\n        this.emit('connect', new Base.ConnectEvent());\n      } else {\n        var message = \"Can't establish a connection to the server at \" + this._origin.href;\n        this.emit('error', new Error(message));\n      }\n      this.end();\n      return !this._paused;\n    },\n    end: function (chunk) {\n      if (!this.writable) return;\n      if (chunk !== undefined) this.write(chunk);\n      this.readable = this.writable = false;\n      this.emit('close');\n      this.emit('end');\n    },\n    destroy: function () {\n      this.end();\n    }\n  };\n  for (var key in instance) Proxy.prototype[key] = instance[key];\n  module.exports = Proxy;\n});","lineCount":83,"map":[[2,2,1,0],[2,14,1,12],[4,2,3,0],[4,6,3,4,"Buffer"],[4,12,3,10],[4,15,3,17,"require"],[4,22,3,24],[4,23,3,24,"_dependencyMap"],[4,37,3,24],[4,55,3,38],[4,56,3,39],[4,57,3,40,"Buffer"],[4,63,3,46],[5,4,4,4,"Stream"],[5,10,4,10],[5,13,4,17,"require"],[5,20,4,24],[5,21,4,24,"_dependencyMap"],[5,35,4,24],[5,48,4,33],[5,49,4,34],[5,50,4,35,"Stream"],[5,56,4,41],[6,4,5,4,"url"],[6,7,5,7],[6,10,5,17,"require"],[6,17,5,24],[6,18,5,24,"_dependencyMap"],[6,32,5,24],[6,42,5,30],[6,43,5,31],[7,4,6,4,"util"],[7,8,6,8],[7,11,6,17,"require"],[7,18,6,24],[7,19,6,24,"_dependencyMap"],[7,33,6,24],[7,44,6,31],[7,45,6,32],[8,4,7,4,"Base"],[8,8,7,8],[8,11,7,17,"require"],[8,18,7,24],[8,19,7,24,"_dependencyMap"],[8,33,7,24],[8,46,7,33],[8,47,7,34],[9,4,8,4,"Headers"],[9,11,8,11],[9,14,8,17,"require"],[9,21,8,24],[9,22,8,24,"_dependencyMap"],[9,36,8,24],[9,52,8,36],[9,53,8,37],[10,4,9,4,"HttpParser"],[10,14,9,14],[10,17,9,17,"require"],[10,24,9,24],[10,25,9,24,"_dependencyMap"],[10,39,9,24],[10,60,9,41],[10,61,9,42],[11,2,11,0],[11,6,11,4,"PORTS"],[11,11,11,9],[11,14,11,12],[12,4,11,14],[12,9,11,19],[12,11,11,21],[12,13,11,23],[13,4,11,25],[13,10,11,31],[13,12,11,33],[14,2,11,37],[14,3,11,38],[15,2,13,0],[15,6,13,4,"Proxy"],[15,11,13,9],[15,14,13,12],[15,23,13,12,"Proxy"],[15,24,13,21,"client"],[15,30,13,27],[15,32,13,29,"origin"],[15,38,13,35],[15,40,13,37,"options"],[15,47,13,44],[15,49,13,46],[16,4,14,2],[16,8,14,6],[16,9,14,7,"_client"],[16,16,14,14],[16,19,14,18,"client"],[16,25,14,24],[17,4,15,2],[17,8,15,6],[17,9,15,7,"_http"],[17,14,15,12],[17,17,15,18],[17,21,15,22,"HttpParser"],[17,31,15,32],[17,32,15,33],[17,42,15,43],[17,43,15,44],[18,4,16,2],[18,8,16,6],[18,9,16,7,"_origin"],[18,16,16,14],[18,19,16,19],[18,26,16,26,"client"],[18,32,16,32],[18,33,16,33,"url"],[18,36,16,36],[18,41,16,41],[18,49,16,49],[18,52,16,53,"client"],[18,58,16,59],[18,59,16,60,"url"],[18,62,16,63],[18,65,16,66,"url"],[18,68,16,69],[18,69,16,70,"parse"],[18,74,16,75],[18,75,16,76,"client"],[18,81,16,82],[18,82,16,83,"url"],[18,85,16,86],[18,86,16,87],[19,4,17,2],[19,8,17,6],[19,9,17,7,"_url"],[19,13,17,11],[19,16,17,19],[19,23,17,26,"origin"],[19,29,17,32],[19,34,17,37],[19,42,17,45],[19,45,17,49,"origin"],[19,51,17,55],[19,54,17,58,"url"],[19,57,17,61],[19,58,17,62,"parse"],[19,63,17,67],[19,64,17,68,"origin"],[19,70,17,74],[19,71,17,75],[20,4,18,2],[20,8,18,6],[20,9,18,7,"_options"],[20,17,18,15],[20,20,18,18,"options"],[20,27,18,25],[20,31,18,29],[20,32,18,30],[20,33,18,31],[21,4,19,2],[21,8,19,6],[21,9,19,7,"_state"],[21,15,19,13],[21,18,19,18],[21,19,19,19],[22,4,21,2],[22,8,21,6],[22,9,21,7,"readable"],[22,17,21,15],[22,20,21,18],[22,24,21,22],[22,25,21,23,"writable"],[22,33,21,31],[22,36,21,34],[22,40,21,38],[23,4,22,2],[23,8,22,6],[23,9,22,7,"_paused"],[23,16,22,14],[23,19,22,18],[23,24,22,23],[24,4,24,2],[24,8,24,6],[24,9,24,7,"_headers"],[24,17,24,15],[24,20,24,18],[24,24,24,22,"Headers"],[24,31,24,29],[24,32,24,30],[24,33,24,31],[25,4,25,2],[25,8,25,6],[25,9,25,7,"_headers"],[25,17,25,15],[25,18,25,16,"set"],[25,21,25,19],[25,22,25,20],[25,28,25,26],[25,30,25,28],[25,34,25,32],[25,35,25,33,"_origin"],[25,42,25,40],[25,43,25,41,"host"],[25,47,25,45],[25,48,25,46],[26,4,26,2],[26,8,26,6],[26,9,26,7,"_headers"],[26,17,26,15],[26,18,26,16,"set"],[26,21,26,19],[26,22,26,20],[26,34,26,32],[26,36,26,34],[26,48,26,46],[26,49,26,47],[27,4,27,2],[27,8,27,6],[27,9,27,7,"_headers"],[27,17,27,15],[27,18,27,16,"set"],[27,21,27,19],[27,22,27,20],[27,40,27,38],[27,42,27,40],[27,54,27,52],[27,55,27,53],[28,4,29,2],[28,8,29,6,"auth"],[28,12,29,10],[28,15,29,13],[28,19,29,17],[28,20,29,18,"_url"],[28,24,29,22],[28,25,29,23,"auth"],[28,29,29,27],[28,33,29,31,"Buffer"],[28,39,29,37],[28,40,29,38,"from"],[28,44,29,42],[28,45,29,43],[28,49,29,47],[28,50,29,48,"_url"],[28,54,29,52],[28,55,29,53,"auth"],[28,59,29,57],[28,61,29,59],[28,67,29,65],[28,68,29,66],[28,69,29,67,"toString"],[28,77,29,75],[28,78,29,76],[28,86,29,84],[28,87,29,85],[29,4,30,2],[29,8,30,6,"auth"],[29,12,30,10],[29,14,30,12],[29,18,30,16],[29,19,30,17,"_headers"],[29,27,30,25],[29,28,30,26,"set"],[29,31,30,29],[29,32,30,30],[29,53,30,51],[29,55,30,53],[29,63,30,61],[29,66,30,64,"auth"],[29,70,30,68],[29,71,30,69],[30,2,31,0],[30,3,31,1],[31,2,32,0,"util"],[31,6,32,4],[31,7,32,5,"inherits"],[31,15,32,13],[31,16,32,14,"Proxy"],[31,21,32,19],[31,23,32,21,"Stream"],[31,29,32,27],[31,30,32,28],[32,2,34,0],[32,6,34,4,"instance"],[32,14,34,12],[32,17,34,15],[33,4,35,2,"setHeader"],[33,13,35,11],[33,15,35,13],[33,24,35,13,"setHeader"],[33,25,35,22,"name"],[33,29,35,26],[33,31,35,28,"value"],[33,36,35,33],[33,38,35,35],[34,6,36,4],[34,10,36,8],[34,14,36,12],[34,15,36,13,"_state"],[34,21,36,19],[34,26,36,24],[34,27,36,25],[34,29,36,27],[34,36,36,34],[34,41,36,39],[35,6,37,4],[35,10,37,8],[35,11,37,9,"_headers"],[35,19,37,17],[35,20,37,18,"set"],[35,23,37,21],[35,24,37,22,"name"],[35,28,37,26],[35,30,37,28,"value"],[35,35,37,33],[35,36,37,34],[36,6,38,4],[36,13,38,11],[36,17,38,15],[37,4,39,2],[37,5,39,3],[38,4,41,2,"start"],[38,9,41,7],[38,11,41,9],[38,20,41,9,"start"],[38,21,41,9],[38,23,41,20],[39,6,42,4],[39,10,42,8],[39,14,42,12],[39,15,42,13,"_state"],[39,21,42,19],[39,26,42,24],[39,27,42,25],[39,29,42,27],[39,36,42,34],[39,41,42,39],[40,6,43,4],[40,10,43,8],[40,11,43,9,"_state"],[40,17,43,15],[40,20,43,18],[40,21,43,19],[41,6,45,4],[41,10,45,8,"origin"],[41,16,45,14],[41,19,45,17],[41,23,45,21],[41,24,45,22,"_origin"],[41,31,45,29],[42,8,46,8,"port"],[42,12,46,12],[42,15,46,17,"origin"],[42,21,46,23],[42,22,46,24,"port"],[42,26,46,28],[42,30,46,32,"PORTS"],[42,35,46,37],[42,36,46,38,"origin"],[42,42,46,44],[42,43,46,45,"protocol"],[42,51,46,53],[42,52,46,54],[43,8,47,8,"start"],[43,13,47,13],[43,16,47,17],[43,26,47,27],[43,29,47,30,"origin"],[43,35,47,36],[43,36,47,37,"hostname"],[43,44,47,45],[43,47,47,48],[43,50,47,51],[43,53,47,54,"port"],[43,57,47,58],[43,60,47,61],[43,71,47,72],[44,6,49,4],[44,10,49,8,"headers"],[44,17,49,15],[44,20,49,18],[44,21,49,19,"start"],[44,26,49,24],[44,28,49,26],[44,32,49,30],[44,33,49,31,"_headers"],[44,41,49,39],[44,42,49,40,"toString"],[44,50,49,48],[44,51,49,49],[44,52,49,50],[44,54,49,52],[44,56,49,54],[44,57,49,55],[45,6,51,4],[45,10,51,8],[45,11,51,9,"emit"],[45,15,51,13],[45,16,51,14],[45,22,51,20],[45,24,51,22,"Buffer"],[45,30,51,28],[45,31,51,29,"from"],[45,35,51,33],[45,36,51,34,"headers"],[45,43,51,41],[45,44,51,42,"join"],[45,48,51,46],[45,49,51,47],[45,55,51,53],[45,56,51,54],[45,58,51,56],[45,64,51,62],[45,65,51,63],[45,66,51,64],[46,6,52,4],[46,13,52,11],[46,17,52,15],[47,4,53,2],[47,5,53,3],[48,4,55,2,"pause"],[48,9,55,7],[48,11,55,9],[48,20,55,9,"pause"],[48,21,55,9],[48,23,55,20],[49,6,56,4],[49,10,56,8],[49,11,56,9,"_paused"],[49,18,56,16],[49,21,56,19],[49,25,56,23],[50,4,57,2],[50,5,57,3],[51,4,59,2,"resume"],[51,10,59,8],[51,12,59,10],[51,21,59,10,"resume"],[51,22,59,10],[51,24,59,21],[52,6,60,4],[52,10,60,8],[52,11,60,9,"_paused"],[52,18,60,16],[52,21,60,19],[52,26,60,24],[53,6,61,4],[53,10,61,8],[53,11,61,9,"emit"],[53,15,61,13],[53,16,61,14],[53,23,61,21],[53,24,61,22],[54,4,62,2],[54,5,62,3],[55,4,64,2,"write"],[55,9,64,7],[55,11,64,9],[55,20,64,9,"write"],[55,21,64,18,"chunk"],[55,26,64,23],[55,28,64,25],[56,6,65,4],[56,10,65,8],[56,11,65,9],[56,15,65,13],[56,16,65,14,"writable"],[56,24,65,22],[56,26,65,24],[56,33,65,31],[56,38,65,36],[57,6,67,4],[57,10,67,8],[57,11,67,9,"_http"],[57,16,67,14],[57,17,67,15,"parse"],[57,22,67,20],[57,23,67,21,"chunk"],[57,28,67,26],[57,29,67,27],[58,6,68,4],[58,10,68,8],[58,11,68,9],[58,15,68,13],[58,16,68,14,"_http"],[58,21,68,19],[58,22,68,20,"isComplete"],[58,32,68,30],[58,33,68,31],[58,34,68,32],[58,36,68,34],[58,43,68,41],[58,44,68,42],[58,48,68,46],[58,49,68,47,"_paused"],[58,56,68,54],[59,6,70,4],[59,10,70,8],[59,11,70,9,"statusCode"],[59,21,70,19],[59,24,70,22],[59,28,70,26],[59,29,70,27,"_http"],[59,34,70,32],[59,35,70,33,"statusCode"],[59,45,70,43],[60,6,71,4],[60,10,71,8],[60,11,71,9,"headers"],[60,18,71,16],[60,21,71,22],[60,25,71,26],[60,26,71,27,"_http"],[60,31,71,32],[60,32,71,33,"headers"],[60,39,71,40],[61,6,73,4],[61,10,73,8],[61,14,73,12],[61,15,73,13,"statusCode"],[61,25,73,23],[61,30,73,28],[61,33,73,31],[61,35,73,33],[62,8,74,6],[62,12,74,10],[62,13,74,11,"emit"],[62,17,74,15],[62,18,74,16],[62,27,74,25],[62,29,74,27],[62,33,74,31,"Base"],[62,37,74,35],[62,38,74,36,"ConnectEvent"],[62,50,74,48],[62,51,74,49],[62,52,74,50],[62,53,74,51],[63,6,75,4],[63,7,75,5],[63,13,75,11],[64,8,76,6],[64,12,76,10,"message"],[64,19,76,17],[64,22,76,20],[64,70,76,68],[64,73,76,71],[64,77,76,75],[64,78,76,76,"_origin"],[64,85,76,83],[64,86,76,84,"href"],[64,90,76,88],[65,8,77,6],[65,12,77,10],[65,13,77,11,"emit"],[65,17,77,15],[65,18,77,16],[65,25,77,23],[65,27,77,25],[65,31,77,29,"Error"],[65,36,77,34],[65,37,77,35,"message"],[65,44,77,42],[65,45,77,43],[65,46,77,44],[66,6,78,4],[67,6,79,4],[67,10,79,8],[67,11,79,9,"end"],[67,14,79,12],[67,15,79,13],[67,16,79,14],[68,6,80,4],[68,13,80,11],[68,14,80,12],[68,18,80,16],[68,19,80,17,"_paused"],[68,26,80,24],[69,4,81,2],[69,5,81,3],[70,4,83,2,"end"],[70,7,83,5],[70,9,83,7],[70,18,83,7,"end"],[70,19,83,16,"chunk"],[70,24,83,21],[70,26,83,23],[71,6,84,4],[71,10,84,8],[71,11,84,9],[71,15,84,13],[71,16,84,14,"writable"],[71,24,84,22],[71,26,84,24],[72,6,85,4],[72,10,85,8,"chunk"],[72,15,85,13],[72,20,85,18,"undefined"],[72,29,85,27],[72,31,85,29],[72,35,85,33],[72,36,85,34,"write"],[72,41,85,39],[72,42,85,40,"chunk"],[72,47,85,45],[72,48,85,46],[73,6,86,4],[73,10,86,8],[73,11,86,9,"readable"],[73,19,86,17],[73,22,86,20],[73,26,86,24],[73,27,86,25,"writable"],[73,35,86,33],[73,38,86,36],[73,43,86,41],[74,6,87,4],[74,10,87,8],[74,11,87,9,"emit"],[74,15,87,13],[74,16,87,14],[74,23,87,21],[74,24,87,22],[75,6,88,4],[75,10,88,8],[75,11,88,9,"emit"],[75,15,88,13],[75,16,88,14],[75,21,88,19],[75,22,88,20],[76,4,89,2],[76,5,89,3],[77,4,91,2,"destroy"],[77,11,91,9],[77,13,91,11],[77,22,91,11,"destroy"],[77,23,91,11],[77,25,91,22],[78,6,92,4],[78,10,92,8],[78,11,92,9,"end"],[78,14,92,12],[78,15,92,13],[78,16,92,14],[79,4,93,2],[80,2,94,0],[80,3,94,1],[81,2,96,0],[81,7,96,5],[81,11,96,9,"key"],[81,14,96,12],[81,18,96,16,"instance"],[81,26,96,24],[81,28,97,2,"Proxy"],[81,33,97,7],[81,34,97,8,"prototype"],[81,43,97,17],[81,44,97,18,"key"],[81,47,97,21],[81,48,97,22],[81,51,97,25,"instance"],[81,59,97,33],[81,60,97,34,"key"],[81,63,97,37],[81,64,97,38],[82,2,99,0,"module"],[82,8,99,6],[82,9,99,7,"exports"],[82,16,99,14],[82,19,99,17,"Proxy"],[82,24,99,22],[83,0,99,23],[83,3]],"functionMap":{"names":["<global>","Proxy","instance.setHeader","instance.start","instance.pause","instance.resume","instance.write","instance.end","instance.destroy"],"mappings":"AAA;YCY;CDkB;aEI;GFI;SGE;GHY;SIE;GJE;UKE;GLG;SME;GNiB;OOE;GPM;WQE;GRE"},"hasCjsExports":true},"type":"js/module"}]}